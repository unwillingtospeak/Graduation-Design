{"version":3,"file":"StockControl.js","sourceRoot":"","sources":["../../../../../../src/.internal/charts/stock/toolbar/StockControl.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,MAAM,EAAkD,MAAM,2BAA2B,CAAA;AAClG,OAAO,EAAE,UAAU,EAAE,MAAM,cAAc,CAAC;AAM1C,kDAAkD;AAClD,OAAO,KAAK,MAAM,MAAM,0BAA0B,CAAC;AAqEnD;;GAEG;AACH;IAAkC,gCAAM;IAAxC;;IAmJA,CAAC;IA3IA,iDAAiD;;;;;eAEjD;YACC,iBAAM,SAAS,WAAE,CAAC;YAElB,oCAAoC;YACpC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,cAAc,CAAC;YAC5D,iBAAM,oBAAoB,WAAE,CAAC;YAE7B,IAAI,CAAC,aAAa,EAAE,CAAC;YACrB,IAAI,CAAC,gBAAgB,EAAE,CAAC;YAExB,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QAC9B,CAAC;;;;;;eAED;YAAA,iBAwCC;YAvCA,gBAAgB;YAChB,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC7C,MAAM,CAAC,YAAY,CAAC,OAAO,EAAE,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;YAC5E,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YAElC,cAAc;YACd,IAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC3C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;YAClC,IAAI,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,MAAM,EAAE;gBAC/B,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;aAC5B;YACD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YACzB,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;YAE9B,eAAe;YACf,IAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;YAClC,IAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC5C,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC;YACvB,IAAI,IAAI,IAAI,EAAE,EAAE;gBACf,KAAK,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;aAC7B;YACD,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YAC1B,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;YAEhC,kBAAkB;YAClB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,MAAM,EAAE,OAAO,EAAE,UAAC,EAAE;gBAChE,gCAAgC;gBAChC,IAAI,KAAI,CAAC,GAAG,CAAC,WAAW,CAAC,IAAI,KAAK,EAAE;oBACnC,KAAI,CAAC,YAAY,EAAE,CAAC;iBACpB;gBAED,IAAI,KAAI,CAAC,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE;oBACnC,KAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,EAAE;wBAC7B,IAAI,EAAE,OAAO;wBACb,MAAM,EAAE,KAAI;wBACZ,aAAa,EAAiB,EAAE;qBAChC,CAAC,CAAA;iBACF;YACF,CAAC,CAAC,CAAC,CAAC;QACL,CAAC;;;;;;eAED;YACC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAE,CAAC,SAAS,GAAG,mDAAmD,CAAC;YAC3F,IAAI,CAAC,UAAU,CAAC,OAAO,CAAE,CAAC,SAAS,GAAG,wBAAwB,CAAC;YAC/D,IAAI,CAAC,UAAU,CAAC,MAAM,CAAE,CAAC,SAAS,GAAG,uBAAuB,CAAC;QAC9D,CAAC;;;;;;eAED;YACC,IAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAClC,IAAI,QAAQ,IAAI,QAAQ,IAAI,MAAM,EAAE;gBACnC,OAAO,QAAQ,CAAC;aAChB;YACD,OAAO,IAAI,CAAC,eAAe,EAAE,CAAC;QAC/B,CAAC;;;;;;eAED;YACC,OAAO,UAAU,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QACtC,CAAC;;;;;;eAED;YACC,iBAAM,cAAc,WAAE,CAAC;YAEvB,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;gBACpD,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAE,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;aAClD;YAED,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;gBACzB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,CAAC;aACrC;YAED,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;gBAC3B,IAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAE,CAAC;gBAC1C,IAAI,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;oBACvB,MAAM,CAAC,QAAQ,CAAC,MAAM,EAAE,gCAAgC,CAAC,CAAC;iBAC1D;qBACI;oBACJ,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,gCAAgC,CAAC,CAAC;iBAC7D;aACD;YAED,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;gBAC1B,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,OAAO,EAAE;oBACjC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAE,EAAE,sBAAsB,CAAC,CAAC;iBACpE;qBACI;oBACJ,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAE,EAAE,sBAAsB,CAAC,CAAC;iBACvE;aACD;YAED,YAAY;QACb,CAAC;;;;;;eAED;YACC,iBAAM,QAAQ,WAAE,CAAC;YAEjB,4CAA4C;YAC5C,gBAAgB;YAChB,MAAM;QACP,CAAC;;;;;;eAED,UAAoB,IAAY;YAC/B,IAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAE,CAAC;YACxC,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC;YACvB,IAAI,IAAI,IAAI,EAAE,EAAE;gBACf,KAAK,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;aAC7B;iBACI;gBACJ,KAAK,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC;aACzB;QACF,CAAC;;;;;;eAED;YACC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAE,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;QACnD,CAAC;;;;;;eAED;YACC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAE,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC;QAC/C,CAAC;;;;;;eAED;YACC,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC;QACzC,CAAC;;IAhJD;;;;eAAkC,cAAc;OAAC;IACjD;;;;eAA0C,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;OAAC;IAiJ9F,mBAAC;CAAA,AAnJD,CAAkC,MAAM,GAmJvC;SAnJY,YAAY","sourcesContent":["import { Entity, IEntitySettings, IEntityPrivate, IEntityEvents } from \"../../../core/util/Entity\"\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport type { IPointerEvent } from \"../../../core/render/backend/Renderer\";\r\nimport type { StockToolbar } from \"./StockToolbar\";\r\nimport type { StockChart } from \"../StockChart\";\r\n\r\n//import * as $array from \"../../core/util/Array\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface IStockControlSettings extends IEntitySettings {\r\n\r\n\t/**\r\n\t * A [[StockChart]] the toolbar is for.\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n\t/**\r\n\t * Is control visible?\r\n\t * \r\n\t * @default true\r\n\t */\r\n\tvisible?: boolean;\r\n\r\n\t/**\r\n\t * Name of the control. Used for the label.\r\n\t */\r\n\tname?: string;\r\n\r\n\t/**\r\n\t * Description of what the button does.\r\n\t */\r\n\tdescription?: string;\r\n\r\n\t/**\r\n\t * An element with control icon. If not set, each control will aytomatically\r\n\t * create an icon.\r\n\t */\r\n\ticon?: HTMLElement | SVGElement | \"none\";\r\n\r\n\t/**\r\n\t * Indicates if control is active.\r\n\t * \r\n\t * @default false\r\n\t */\r\n\tactive?: boolean;\r\n\r\n\t/**\r\n\t * If set to `true`, control can be toggle on and off by clicking on it.\r\n\t * \r\n\t * @default true\r\n\t */\r\n\ttogglable?: boolean;\r\n\r\n\t/**\r\n\t * Alignment of the control in a toolbar.\r\n\t *\r\n\t * @default \"left\"\r\n\t */\r\n\talign?: \"left\" | \"right\";\r\n\r\n}\r\n\r\n\r\nexport interface IStockControlPrivate extends IEntityPrivate {\r\n\ttoolbar: StockToolbar;\r\n\tbutton?: HTMLDivElement;\r\n\ticon?: HTMLElement;\r\n\tlabel?: HTMLDivElement;\r\n}\r\n\r\nexport interface IStockControlEvents extends IEntityEvents {\r\n\tclick: {\r\n\t\toriginalEvent: IPointerEvent\r\n\t}\r\n}\r\n\r\n/**\r\n * @todo revview\r\n */\r\nexport class StockControl extends Entity {\r\n\tpublic static className: string = \"StockControl\";\r\n\tpublic static classNames: Array<string> = Entity.classNames.concat([StockControl.className]);\r\n\r\n\tdeclare public _settings: IStockControlSettings;\r\n\tdeclare public _privateSettings: IStockControlPrivate;\r\n\tdeclare public _events: IStockControlEvents;\r\n\r\n\t// private _itemDisposers: Array<IDisposer> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Inherit default themes from chart\r\n\t\tthis._defaultThemes = this.get(\"stockChart\")._defaultThemes;\r\n\t\tsuper._afterNewApplyThemes();\r\n\r\n\t\tthis._initElements();\r\n\t\tthis._applyClassNames();\r\n\r\n\t\tthis._root.addDisposer(this);\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\t// Create button\r\n\t\tconst button = document.createElement(\"div\");\r\n\t\tbutton.setAttribute(\"title\", this.get(\"description\", this.get(\"name\", \"\")));\r\n\t\tthis.setPrivate(\"button\", button);\r\n\r\n\t\t// Create icon\r\n\t\tconst icon = document.createElement(\"div\");\r\n\t\ticon.appendChild(this._getIcon());\r\n\t\tif (this.get(\"icon\") == \"none\") {\r\n\t\t\ticon.style.display = \"none\";\r\n\t\t}\r\n\t\tbutton.appendChild(icon);\r\n\t\tthis.setPrivate(\"icon\", icon);\r\n\r\n\t\t// Create label\r\n\t\tconst name = this.get(\"name\", \"\");\r\n\t\tconst label = document.createElement(\"div\");\r\n\t\tlabel.innerHTML = name;\r\n\t\tif (name == \"\") {\r\n\t\t\tlabel.style.display = \"none\";\r\n\t\t}\r\n\t\tbutton.appendChild(label);\r\n\t\tthis.setPrivate(\"label\", label);\r\n\r\n\t\t// Add click event\r\n\t\tthis._disposers.push($utils.addEventListener(button, \"click\", (ev) => {\r\n\t\t\t//ev.stopImmediatePropagation();\r\n\t\t\tif (this.get(\"togglable\") != false) {\r\n\t\t\t\tthis._handleClick();\r\n\t\t\t}\r\n\r\n\t\t\tif (this.events.isEnabled(\"click\")) {\r\n\t\t\t\tthis.events.dispatch(\"click\", {\r\n\t\t\t\t\ttype: \"click\",\r\n\t\t\t\t\ttarget: this,\r\n\t\t\t\t\toriginalEvent: <IPointerEvent>ev\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\r\n\tprotected _applyClassNames(): void {\r\n\t\tthis.getPrivate(\"button\")!.className = \"am5stock am5stock-control am5stock-control-button\";\r\n\t\tthis.getPrivate(\"label\")!.className = \"am5stock-control-label\";\r\n\t\tthis.getPrivate(\"icon\")!.className = \"am5stock-control-icon\";\r\n\t}\r\n\r\n\tprotected _getIcon(): HTMLElement | SVGElement {\r\n\t\tconst userIcon = this.get(\"icon\");\r\n\t\tif (userIcon && userIcon != \"none\") {\r\n\t\t\treturn userIcon;\r\n\t\t}\r\n\t\treturn this._getDefaultIcon();\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Default\");\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\tif (this.isDirty(\"visible\") && !this.get(\"visible\")) {\r\n\t\t\tthis.getPrivate(\"button\")!.style.display = \"none\";\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"name\")) {\r\n\t\t\tthis._setLabel(this.get(\"name\", \"\"));\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"active\")) {\r\n\t\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\t\tif (this.get(\"active\")) {\r\n\t\t\t\t$utils.addClass(button, \"am5stock-control-button-active\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$utils.removeClass(button, \"am5stock-control-button-active\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"align\")) {\r\n\t\t\tif (this.get(\"align\") == \"right\") {\r\n\t\t\t\t$utils.addClass(this.getPrivate(\"button\")!, \"am5stock-align-right\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$utils.removeClass(this.getPrivate(\"button\")!, \"am5stock-align-right\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// todo icon\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\r\n\t\t// $array.each(this._itemDisposers, (x) => {\r\n\t\t// \tx.dispose();\r\n\t\t// });\r\n\t}\r\n\r\n\tprotected _setLabel(name: string): void {\r\n\t\tconst label = this.getPrivate(\"label\")!;\r\n\t\tlabel.innerHTML = name;\r\n\t\tif (name == \"\") {\r\n\t\t\tlabel.style.display = \"none\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlabel.style.display = \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tthis.getPrivate(\"button\")!.style.display = \"none\";\r\n\t}\r\n\r\n\tpublic show(): void {\r\n\t\tthis.getPrivate(\"button\")!.style.display = \"\";\r\n\t}\r\n\r\n\tprotected _handleClick(): void {\r\n\t\tthis.set(\"active\", !this.get(\"active\"));\r\n\t}\r\n\r\n}"]}