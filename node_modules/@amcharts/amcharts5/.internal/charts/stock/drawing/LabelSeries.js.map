{"version":3,"file":"LabelSeries.js","sourceRoot":"","sources":["../../../../../../src/.internal/charts/stock/drawing/LabelSeries.ts"],"names":[],"mappings":"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","sourcesContent":["import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { Container } from \"../../../core/render/Container\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\n\r\nimport { PolylineSeries, IPolylineSeriesSettings, IPolylineSeriesPrivate, IPolylineSeriesDataItem } from \"./PolylineSeries\";\r\nimport { Label } from \"../../../core/render/Label\";\r\nimport { RoundedRectangle } from \"../../../core/render/RoundedRectangle\";\r\nimport { SpriteResizer } from \"./SpriteResizer\";\r\nimport { color, Color } from \"../../../core/util/Color\";\r\n\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface ILabelSeriesDataItem extends IPolylineSeriesDataItem {\r\n}\r\n\r\nexport interface ILabelSeriesSettings extends IPolylineSeriesSettings {\r\n\r\n\t/**\r\n\t * Label font size.\r\n\t */\r\n\tlabelFontSize?: number | string | undefined;\r\n\r\n\t/**\r\n\t * Label font damily.\r\n\t */\r\n\tlabelFontFamily?: string;\r\n\r\n\t/**\r\n\t * Font weight.\r\n\t */\r\n\tlabelFontWeight?: \"normal\" | \"bold\" | \"bolder\" | \"lighter\" | \"100\" | \"200\" | \"300\" | \"400\" | \"500\" | \"600\" | \"700\" | \"800\" | \"900\";\r\n\r\n\t/**\r\n\t * Font style.\r\n\t */\r\n\tlabelFontStyle?: \"normal\" | \"italic\" | \"oblique\";\r\n\r\n\t/**\r\n\t * Label color.\r\n\t */\r\n\tlabelFill?: Color;\r\n\r\n}\r\n\r\nexport interface ILabelSeriesPrivate extends IPolylineSeriesPrivate {\r\n\tinputContainer: HTMLDivElement;\r\n\tinput: HTMLTextAreaElement;\r\n\tlabel: Label;\r\n}\r\n\r\nexport class LabelSeries extends PolylineSeries {\r\n\tpublic static className: string = \"LabelSeries\";\r\n\tpublic static classNames: Array<string> = PolylineSeries.classNames.concat([LabelSeries.className]);\r\n\r\n\tdeclare public _settings: ILabelSeriesSettings;\r\n\tdeclare public _privateSettings: ILabelSeriesPrivate;\r\n\tdeclare public _dataItemSettings: ILabelSeriesDataItem;\r\n\r\n\tpublic spriteResizer = this.children.push(SpriteResizer.new(this._root, {}));\r\n\r\n\tprotected _clickEvent?: ISpritePointerEvent;\r\n\r\n\tprotected _tag = \"label\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.strokes.template.set(\"visible\", false);\r\n\t\tthis.fills.template.set(\"visible\", false);\r\n\r\n\t\tthis.addTag(this._tag);\r\n\r\n\t\tconst div = document.createElement(\"div\");\r\n\t\t//div.style.width = \"300px\";\r\n\t\tdiv.style.position = \"absolute\";\r\n\t\tdiv.style.display = \"none\";\r\n\t\tdiv.className = \"am5stock-drawing-label-wrapper\";\r\n\t\tthis._root._inner.appendChild(div);\r\n\t\tthis.setPrivate(\"inputContainer\", div);\r\n\r\n\t\tconst textArea = document.createElement(\"textarea\");;\r\n\t\t//textArea.style.textAlign = \"center\";\r\n\t\t//textArea.rows = 2;\r\n\t\ttextArea.className = \"am5stock-drawing-label-input\";\r\n\t\t$utils.addEventListener(textArea, \"input\", () => {\r\n\t\t\ttextArea.style.height = \"auto\";\r\n\t\t\ttextArea.style.height = textArea.scrollHeight + \"px\";\r\n\t\t}, false);\r\n\r\n\r\n\t\tdiv.appendChild(textArea);\r\n\t\tdiv.appendChild(document.createElement(\"br\"));\r\n\t\tthis.setPrivate(\"input\", textArea);\r\n\r\n\t\tconst saveButton = document.createElement(\"input\");\r\n\t\tsaveButton.type = \"button\";\r\n\t\tsaveButton.value = this._root.language.translateAny(\"Save\");\r\n\t\tsaveButton.className = \"am5-modal-button am5-modal-primary\";\r\n\t\t$utils.addEventListener(saveButton, \"click\", () => {\r\n\t\t\tthis.saveText();\r\n\t\t});\r\n\r\n\t\tdiv.appendChild(saveButton);\r\n\r\n\t\tconst cancelButton = document.createElement(\"input\");\r\n\t\tcancelButton.type = \"button\";\r\n\t\tcancelButton.value = this._root.language.translateAny(\"Cancel\");\r\n\t\tcancelButton.className = \"am5-modal-button am5-modal-scondary\";\r\n\t\t$utils.addEventListener(cancelButton, \"click\", () => {\r\n\t\t\tthis.getPrivate(\"inputContainer\").style.display = \"none\";\r\n\t\t\tthis.getPrivate(\"input\").value = \"\";\r\n\t\t});\r\n\t\tdiv.appendChild(cancelButton);\r\n\t}\r\n\r\n\tprotected _tweakBullet(container: Container) {\r\n\t\tconst label = container.children.push(Label.new(this._root, {\r\n\t\t\tthemeTags: [\"label\"],\r\n\t\t\ttext: this.getPrivate(\"input\").value\r\n\t\t}));\r\n\r\n\t\tthis.setPrivate(\"label\", label);\r\n\r\n\t\tconst fontSize = this.get(\"labelFontSize\");\r\n\t\tif (fontSize != null) {\r\n\t\t\tlabel.set(\"fontSize\", fontSize)\r\n\t\t}\r\n\r\n\t\tconst fontFamily = this.get(\"labelFontFamily\");\r\n\t\tif (fontFamily != null) {\r\n\t\t\tlabel.set(\"fontFamily\", fontFamily)\r\n\t\t}\r\n\r\n\t\tconst fontStyle = this.get(\"labelFontStyle\");\r\n\t\tif (fontStyle != null) {\r\n\t\t\tlabel.set(\"fontStyle\", fontStyle)\r\n\t\t}\r\n\r\n\t\tconst fontWeight = this.get(\"labelFontWeight\");\r\n\t\tif (fontWeight != null) {\r\n\t\t\tlabel.set(\"fontWeight\", fontWeight)\r\n\t\t}\r\n\r\n\t\tcontainer.events.on(\"click\", () => {\r\n\t\t\tthis.spriteResizer.set(\"sprite\", label);\r\n\t\t})\r\n\r\n\t\tcontainer.events.on(\"pointerover\", () => {\r\n\t\t\tthis._isHover = true;\r\n\t\t})\r\n\r\n\t\tcontainer.events.on(\"pointerout\", () => {\r\n\t\t\tthis._isHover = false;\r\n\t\t})\r\n\r\n\t\tthis._tweakBullet2(label);\r\n\t}\r\n\r\n\tprotected _tweakBullet2(label: Label) {\r\n\t\tlabel.set(\"background\", RoundedRectangle.new(this._root, { fillOpacity: 0, strokeOpacity: 0, fill: color(0xffffff) }))\r\n\t\tlabel.set(\"fill\", this.get(\"labelFill\", this.get(\"fillColor\", this.get(\"fill\"))));\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tif (!this._isHover) {\r\n\t\t\tconst input = this.getPrivate(\"input\");\r\n\t\t\tinput.value = \"\";\r\n\r\n\t\t\tthis._clickEvent = event;\r\n\t\t\t//console.log(event);\r\n\t\t\tconst inputDiv = this.getPrivate(\"inputContainer\");\r\n\t\t\tinputDiv.style.display = \"block\";\r\n\t\t\tinputDiv.style.left = (event.point.x) + \"px\";\r\n\t\t\tinputDiv.style.top = (event.point.y) + \"px\";\r\n\t\t\tinput.focus();\r\n\t\t\tthis.spriteResizer.set(\"sprite\", undefined);\r\n\t\t\tthis._index++;\r\n\t\t\tthis._di[this._index] = {};\r\n\t\t}\r\n\t}\r\n\r\n\tpublic saveText() {\r\n\t\tconst clickEvent = this._clickEvent;\r\n\t\tif (clickEvent) {\r\n\t\t\tif (this.getPrivate(\"input\").value) {\r\n\t\t\t\tsuper._handlePointerClick(clickEvent);\r\n\t\t\t}\r\n\t\t\tthis.getPrivate(\"inputContainer\").style.display = \"none\";\r\n\t\t}\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tthis.spriteResizer.set(\"sprite\", undefined);\r\n\t\tthis._isHover = false;\r\n\t}\r\n\r\n\tprotected _hideAllBullets() {\r\n\r\n\t}\r\n}"]}