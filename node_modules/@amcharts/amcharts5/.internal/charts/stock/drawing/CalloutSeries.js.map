{"version":3,"file":"CalloutSeries.js","sourceRoot":"","sources":["../../../../../../src/.internal/charts/stock/drawing/CalloutSeries.ts"],"names":[],"mappings":"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","sourcesContent":["import type { Label } from \"../../../core/render/Label\";\r\nimport type { Container } from \"../../../core/render/Container\";\r\n\r\nimport { LabelSeries, ILabelSeriesSettings, ILabelSeriesPrivate, ILabelSeriesDataItem } from \"./LabelSeries\";\r\nimport { PointedRectangle } from \"../../../core/render/PointedRectangle\";\r\nimport { Color, color } from \"../../../core/util/Color\";\r\n\r\nimport * as $ease from \"../../../core/util/Ease\";\r\n\r\nexport interface ICalloutSeriesDataItem extends ILabelSeriesDataItem {\r\n\r\n\t/**\r\n\t * Indicates whether callout will attach itself to the closest data item, as\r\n\t * opposed to exact location of the click.\r\n\t */\r\n\tsnapToData?: boolean;\r\n\r\n}\r\n\r\nexport interface ICalloutSeriesSettings extends ILabelSeriesSettings {\r\n\r\n\t/**\r\n\t * If set to `true`, callout will attach itself to the closest data item, as\r\n\t * opposed to exact location of the click.\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tsnapToData?: boolean;\r\n\r\n}\r\n\r\nexport interface ICalloutSeriesPrivate extends ILabelSeriesPrivate {\r\n}\r\n\r\nexport class CalloutSeries extends LabelSeries {\r\n\tpublic static className: string = \"CalloutSeries\";\r\n\tpublic static classNames: Array<string> = LabelSeries.classNames.concat([CalloutSeries.className]);\r\n\r\n\tdeclare public _settings: ICalloutSeriesSettings;\r\n\tdeclare public _privateSettings: ICalloutSeriesPrivate;\r\n\tdeclare public _dataItemSettings: ICalloutSeriesDataItem;\r\n\r\n\tprotected _tag = \"callout\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t}\r\n\r\n\tprotected _tweakBullet2(label: Label) {\r\n\t\tconst bgColor = this.get(\"fillColor\", this.get(\"fill\", color(0x000000)));\r\n\t\tlabel.set(\"background\", PointedRectangle.new(this._root, { themeTags: [\"callout\"], strokeOpacity: 0, fill: bgColor }));\r\n\t\tlabel.set(\"fill\", this.get(\"labelFill\", Color.alternative(bgColor, this._root.interfaceColors.get(\"alternativeText\"), this._root.interfaceColors.get(\"text\"))));\r\n\t}\r\n\r\n\tprotected _tweakBullet(container: Container) {\r\n\t\tsuper._tweakBullet(container);\r\n\r\n\t\tconst label = this.getPrivate(\"label\");\r\n\t\tif (label) {\r\n\t\t\tlabel.events.on(\"positionchanged\", () => {\r\n\t\t\t\tthis._updatePointer(label);\r\n\t\t\t})\r\n\r\n\t\t\tlabel.events.on(\"click\", () => {\r\n\t\t\t\tthis.spriteResizer.set(\"sprite\", label);\r\n\t\t\t})\r\n\r\n\t\t\tlabel.on(\"scale\", () => {\r\n\t\t\t\tthis._updatePointer(label);\r\n\t\t\t})\r\n\r\n\t\t\tlabel.on(\"rotation\", () => {\r\n\t\t\t\tthis._updatePointer(label);\r\n\t\t\t})\r\n\r\n\t\t\tlabel.setAll({ draggable: true });\r\n\r\n\t\t\tconst defaultState = label.states.lookup(\"default\")!;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tlabel.animate({ key: \"y\", to: -label.height() / 2 - 10, from: 0, duration: defaultState.get(\"stateAnimationDuration\", 500), easing: defaultState.get(\"stateAnimationEasing\", $ease.out($ease.cubic)) })\r\n\t\t\t}, 50)\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updatePointer(label: Label) {\r\n\t\tconst background = label.get(\"background\");\r\n\t\tif (background instanceof PointedRectangle) {\r\n\t\t\tconst parent = label.parent;\r\n\t\t\tif (parent) {\r\n\t\t\t\tlet point = parent.toGlobal({ x: 0, y: 0 });\r\n\t\t\t\tpoint = background.toLocal(point);\r\n\t\t\t\tbackground.setAll({ pointerX: point.x, pointerY: point.y });\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _hideAllBullets() {\r\n\r\n\t}\r\n}"]}