var t=Object.defineProperty,e=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,o,r)=>o in e?t(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,__spreadValues=(t,n)=>{for(var i in n||(n={}))o.call(n,i)&&__defNormalProp(t,i,n[i]);if(e)for(var i of e(n))r.call(n,i)&&__defNormalProp(t,i,n[i]);return t};import{computed as n,unref as i,watchPostEffect as a}from"vue";import{m as l}from"../utils/map-object.mjs";import{u}from"./useDomRect.mjs";import{u as s}from"./useClientOnly.mjs";const c=["top","bottom","left","right"].reduce(((t,e)=>[...t,e,`${e}-start`,`${e}-end`,`${e}-center`]),["auto"]),parsePlacement=t=>{let[e,o]=t.split("-");return"auto"===e&&(e="bottom"),{position:e,align:o||"center"}},calculateContentAlignment=(t,e,o,r)=>"start"===t?e:"end"===t?e+o-r:e+(o-r)/2,calculateContentCoords=(t,e,o)=>{const{position:r,align:n}=parsePlacement(t),i=calculateContentAlignment(n,e.left,e.width,o.width),a=calculateContentAlignment(n,e.top,e.height,o.height);switch(r){case"top":return{x:i,y:e.top-o.height};case"left":return{y:a,x:e.left-o.width};case"right":return{y:a,x:e.right};default:return{x:i,y:e.bottom}}},calculateOffsetCoords=(t,e)=>{const{position:o}=parsePlacement(t),{main:r,cross:n}=(t=>Array.isArray(t)?{main:t[0],cross:t[1]}:{main:t,cross:0})(e);switch(o){case"left":return{y:n,x:-r};case"right":return{y:n,x:r};case"top":return{y:-r,x:n};default:return{y:r,x:n}}},calculateContentOverflow=(t,e,o)=>{const r=o.right,n=o.bottom,i=o.left,a=o.top;return{top:Math.max(a-t.y,0),bottom:Math.max(t.y+e.height-n,0),left:Math.max(i-t.x,0),right:Math.max(t.x+e.width-r,0)}},clamp=(t,e,o)=>Math.max(Math.min(e,o),t),useDropdown=(t,e,o)=>{const r=s((()=>document)),c=n((()=>{if(!r.value)return;const{root:t}=i(o);if(t){let e;return e="string"==typeof t?r.value.querySelector(t):t,e?(t=>{for(;t;){if("relative"===window.getComputedStyle(t).position)return t;t=t.parentElement}return document.body})(e):r.value.body}return r.value.body})),{domRect:m}=u(t),{domRect:p}=u(e),h={width:"max-content",position:"absolute"};return a((()=>{var t,r;if(!c.value||!m.value||!p.value)return;const{placement:n,offset:a,keepAnchorWidth:u,autoPlacement:s,stickToEdges:f}=i(o);let y=calculateContentCoords(n,m.value,p.value),d={x:0,y:0};a&&(d=calculateOffsetCoords(n,a),y=l(y,((t,e)=>t+d[e])));const x=c.value.getBoundingClientRect(),g=null!=(r=null==(t=i(o).viewport)?void 0:t.getBoundingClientRect())?r:x;if(s){const t=((t,e,o,r)=>{const{position:n,align:i}=parsePlacement(t),a=calculateContentOverflow(e,o,r),l={top:["bottom",i].join("-"),bottom:["top",i].join("-"),right:["left",i].join("-"),left:["right",i].join("-")};return a[n]?l[n]:t})(n,y,p.value,g);t!==n&&(y=calculateContentCoords(t,m.value,p.value),a&&(d=calculateOffsetCoords(t,a),y=l(y,((t,e)=>t+d[e]))))}if(f&&(y=((t,e,o,r,n)=>{const{top:i,bottom:a,left:l,right:u}=calculateContentOverflow(t,o,n),s=t.x-u+l,c=t.y-a+i,{x:m,y:p}=e;return{x:clamp(r.left+m-o.width,s,r.right+m),y:clamp(r.top+p-o.height,c,r.bottom+p)}})(y,d,p.value,m.value,g)),y.x-=x.x,y.y-=x.y,e.value){let t={};if(u){const{width:e}=m.value;t={width:`${e}px`,maxWidth:`${e}px`}}Object.assign(e.value.style,__spreadValues(__spreadValues(__spreadValues({},h),(({x:t,y:e})=>({left:`${t}px`,top:`${e}px`}))(y)),t))}})),{anchorDomRect:m,contentDomRect:p}};export{c as p,useDropdown as u};
//# sourceMappingURL=useDropdown.mjs.map
