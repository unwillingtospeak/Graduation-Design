import{watch as e,inject as r,computed as a,onMounted as o,onBeforeUnmount as t}from"vue";import{f as s,e as u,g as l}from"../../vendor.mjs";import{u as i}from"./useSyncProp.mjs";import{a as n}from"./useFocus.mjs";import{F as d}from"../components/va-form/consts.mjs";const m={modelValue:{required:!1},error:{type:Boolean,default:void 0},errorMessages:{type:[Array,String],default:void 0},errorCount:{type:[String,Number],default:1},rules:{type:Array,default:()=>[]},success:{type:Boolean,default:!1},messages:{type:[Array,String],default:()=>[]},immediateValidation:{type:Boolean,default:!1}},p=["update:error","update:errorMessages"],useValidation=(m,p,v,f)=>{const{isFocused:c,onFocus:g,onBlur:y}=n(),[V]=i("error",m,p,!1),[h]=i("errorMessages",m,p,[]),resetValidation=()=>{V.value=!1,h.value=[]},validate=()=>{if(!m.rules||!m.rules.length)return!0;let e=!1,r=[];return((e=[],r=null)=>(l(e)&&(e=[e]),e.map((e=>u(e)?e(r):e))))(s(m.rules),m.modelValue).forEach((a=>{l(a)?(r=[...r,a],e=!0):!1===a&&(e=!0)})),h.value=r,V.value=e,!e};e(c,(e=>!e&&validate())),e((()=>m.modelValue),(()=>validate()),{immediate:m.immediateValidation});const j={resetValidation:resetValidation,focus:f,validate:validate,reset:v,hasError:()=>V.value},A=r(d,void 0),B=a((()=>({"aria-invalid":!!h.value.length,"aria-errormessage":"string"==typeof h.value?h.value:h.value.join(", ")})));return o((()=>{null==A||A.onChildMounted(j)})),t((()=>{null==A||A.onChildUnmounted(j)})),{computedError:V,computedErrorMessages:h,listeners:{onFocus:g,onBlur:y},validate:validate,resetValidation:resetValidation,validationAriaAttributes:B}};export{p as a,useValidation as b,m as u};
//# sourceMappingURL=useValidation.mjs.map
