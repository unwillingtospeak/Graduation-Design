{"version":3,"file":"VaTimePickerColumn.mjs","sources":["../../../../../../../src/components/va-time-picker/components/VaTimePickerColumn/VaTimePickerColumn.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"rootElement\"\n    tabindex=\"0\"\n    class=\"va-time-picker-column\"\n    @keydown.down.stop.prevent=\"makeActiveNext()\"\n    @keydown.space.stop.prevent=\"makeActiveNext(5)\"\n    @keydown.up.stop.prevent=\"makeActivePrev()\"\n    @scroll.passive=\"onScroll\"\n    @touchmove.passive=\"onScroll\"\n  >\n    <div\n      v-for=\"(item, index) in items\" :key=\"item\"\n      class=\"va-time-picker-cell\"\n      :class=\"{ 'va-time-picker-cell--active': index === $props.activeItemIndex }\"\n      @click=\"onCellClick(index)\"\n    >\n      <slot name=\"cell\" v-bind=\"{ item, index, activeItemIndex, items, formattedItem: formatCell(item) }\">\n        {{ formatCell(item) }}\n      </slot>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, nextTick, shallowRef, watch, onMounted, PropType } from 'vue'\n\nimport debounce from 'lodash/debounce.js'\nimport { useSyncProp, useFocus, useFocusEmits } from '../../../../composables'\n\nexport default defineComponent({\n  name: 'VaTimePickerColumn',\n\n  props: {\n    items: { type: Array as PropType<string[] | number[]>, default: () => [] },\n    activeItemIndex: { type: Number, default: 0 },\n    cellHeight: { type: Number, default: 30 },\n  },\n\n  emits: ['item-selected', 'update:activeItemIndex', ...useFocusEmits],\n\n  setup (props, { emit }) {\n    const rootElement = shallowRef<HTMLElement>()\n    const { focus, blur } = useFocus(rootElement, emit)\n    const [syncActiveItemIndex] = useSyncProp('activeItemIndex', props, emit)\n\n    watch(syncActiveItemIndex, (newVal) => { scrollTo(newVal) })\n\n    onMounted(() => scrollTo(syncActiveItemIndex.value, false))\n\n    const scrollTo = (index: number, animated = true) => {\n      nextTick(() => {\n        rootElement.value!.scrollTo({\n          behavior: animated ? 'smooth' : 'auto',\n          top: index * props.cellHeight,\n        })\n      })\n    }\n\n    const makeActiveByIndex = (index: number) => {\n      syncActiveItemIndex.value = index\n      nextTick(() => scrollTo(syncActiveItemIndex.value))\n    }\n\n    const makeActiveNext = (times?: number) => {\n      syncActiveItemIndex.value = (syncActiveItemIndex.value + (times || 1)) % props.items.length\n      nextTick(() => scrollTo(syncActiveItemIndex.value))\n    }\n\n    const makeActivePrev = (times?: number) => {\n      syncActiveItemIndex.value = (syncActiveItemIndex.value - (times || 1) + props.items.length) % props.items.length\n      nextTick(() => scrollTo(syncActiveItemIndex.value))\n    }\n\n    const onCellClick = (index: number) => {\n      syncActiveItemIndex.value = index\n    }\n\n    const formatCell = (n: number | string): string => {\n      if (!Number.isInteger(n)) { return n as string }\n\n      return n < 10 ? `0${n}` : `${n}`\n    }\n\n    const getIndex = () => {\n      const scrollTop = rootElement.value!.scrollTop\n      const calculatedIndex = Math.max(\n        (scrollTop - scrollTop % props.cellHeight) / props.cellHeight,\n        scrollTop / props.cellHeight,\n      )\n\n      if (syncActiveItemIndex.value * props.cellHeight < scrollTop) {\n        return Math.ceil(calculatedIndex)\n      } else if (syncActiveItemIndex.value * props.cellHeight > scrollTop) {\n        return Math.floor(calculatedIndex)\n      } else {\n        return Math.round(calculatedIndex)\n      }\n    }\n\n    const onScroll = debounce(() => {\n      if (rootElement.value && syncActiveItemIndex.value !== -1) {\n        syncActiveItemIndex.value = getIndex()\n      }\n    }, 200)\n\n    return {\n      rootElement,\n\n      makeActiveNext,\n      makeActivePrev,\n      makeActiveByIndex,\n      onScroll,\n\n      onCellClick,\n      formatCell,\n\n      focus,\n      blur,\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n  @import 'variables';\n  @import '../../../../styles/resources';\n\n  @mixin hiddenYScroll {\n    overflow-y: scroll;\n    -ms-overflow-style: none;  /* IE and Edge */\n    scrollbar-width: none;  /* Firefox */\n    &::-webkit-scrollbar { /* WebKit */\n      display: none;\n    }\n  }\n\n  .va-time-picker-column {\n    @include hiddenYScroll();\n\n    height: 100%;\n    border-right: var(--va-time-picker-column-border-right);\n\n    &::before,\n    &::after {\n      content: \"\";\n      display: block;\n      height: var(--va-time-picker-column-gap-height);\n      width: 100%;\n    }\n\n    &:last-child {\n      border-right: 0;\n    }\n\n    .va-time-picker-cell {\n      height: var(--va-time-picker-cell-height);\n      line-height: var(--va-time-picker-cell-height);\n      width: var(--va-time-picker-cell-width);\n      text-align: center;\n      cursor: var(--va-time-picker-cell-cursor);\n      user-select: none;\n\n      &--active {\n        position: relative;\n        color: var(--va-time-picker-cell-active-color);\n        z-index: 0;\n\n        &::before {\n          background: var(--va-time-picker-cell-active-background);\n          position: absolute;\n          height: 100%;\n          width: 100%;\n          left: 0;\n          right: 0;\n          content: '';\n          z-index: -1;\n          opacity: var(--va-time-picker-cell-active-background-opacity);\n        }\n      }\n\n      &:hover {\n        background: var(--va-time-picker-cell-background-color-hover);\n      }\n    }\n\n    &:focus {\n      .va-time-picker-cell {\n        &--active {\n          @include focus-outline($radius: 4px, $offset: -2px);\n        }\n      }\n    }\n  }\n</style>\n"],"names":["_sfc_main","defineComponent","name","props","items","type","Array","default","activeItemIndex","Number","cellHeight","emits","useFocusEmits","setup","emit","rootElement","shallowRef","focus","blur","useFocus","syncActiveItemIndex","useSyncProp","watch","newVal","scrollTo","onMounted","value","index","animated","nextTick","behavior","top","onScroll","debounce","scrollTop","calculatedIndex","Math","max","ceil","floor","round","getIndex","makeActiveNext","times","length","makeActivePrev","makeActiveByIndex","onCellClick","formatCell","n","isInteger","_createElementBlock","ref","tabindex","class","onKeydown","_cache","_withKeys","_withModifiers","$event","_ctx","onScrollPassive","args","onTouchmovePassive","_openBlock","_Fragment","_renderList","item","key","_normalizeClass","onClick","_renderSlot","$slots","_normalizeProps","_guardReactiveProps","formattedItem","_createTextVNode","_toDisplayString"],"mappings":"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"}