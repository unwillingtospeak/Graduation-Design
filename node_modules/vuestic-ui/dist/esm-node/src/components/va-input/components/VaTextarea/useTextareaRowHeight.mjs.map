{"version":3,"file":"useTextareaRowHeight.mjs","sources":["../../../../../../../src/components/va-input/components/VaTextarea/useTextareaRowHeight.ts"],"sourcesContent":["import { Ref } from 'vue'\n\nconst HIDDEN_TEXTAREA_STYLE = `\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important';\n`\n\nconst SIZING_STYLE = [\n  'letter-spacing',\n  'line-height',\n  'padding-top',\n  'padding-bottom',\n  'font-family',\n  'font-weight',\n  'font-size',\n  'text-rendering',\n  'text-transform',\n  'width',\n  'text-indent',\n  'padding-left',\n  'padding-right',\n  'border-width',\n  'box-sizing',\n]\n\nconst getNodeHeightStyles = (node: HTMLElement) => {\n  const style = window.getComputedStyle(node)\n\n  return {\n    boxSizing:\n      style.getPropertyValue('box-sizing') ||\n      style.getPropertyValue('-moz-box-sizing') ||\n      style.getPropertyValue('-webkit-box-sizing'),\n    padding:\n      parseFloat(style.getPropertyValue('padding-bottom')) +\n      parseFloat(style.getPropertyValue('padding-top')),\n    border:\n      parseFloat(style.getPropertyValue('border-bottom-width')) +\n      parseFloat(style.getPropertyValue('border-top-width')),\n    styles:\n      SIZING_STYLE.map(name => `${name}:${style.getPropertyValue(name)}`).join(';') + ';',\n    lineHeight:\n      parseInt(style.getPropertyValue('line-height')),\n  }\n}\n\nlet textarea: null | HTMLTextAreaElement = null\n\nconst createHiddenTextarea = (original: HTMLTextAreaElement, styles: string) => {\n  if (!textarea) {\n    textarea = document.createElement('textarea')\n  }\n\n  textarea.setAttribute('style', styles + HIDDEN_TEXTAREA_STYLE)\n  textarea.value = original.value || original.placeholder || ''\n  const wrap = original.getAttribute('wrap')\n\n  if (wrap !== null) {\n    textarea.setAttribute('wrap', wrap)\n  } else {\n    textarea.removeAttribute('wrap')\n  }\n\n  return textarea\n}\n\nexport const useTextareaRowHeight = (textarea: Ref<HTMLTextAreaElement | undefined>) => {\n  const calculateRowHeight = () => {\n    if (!textarea.value) { return 0 }\n\n    return getNodeHeightStyles(textarea.value).lineHeight\n  }\n\n  const calculateHeight = () => {\n    if (!textarea.value) { return 0 }\n\n    const { boxSizing, padding, border, styles } = getNodeHeightStyles(textarea.value)\n    const hiddenTextarea = createHiddenTextarea(textarea.value, styles)\n    document.body.appendChild(hiddenTextarea)\n    let height = hiddenTextarea.scrollHeight\n\n    if (boxSizing === 'border-box') {\n      height += border\n    } else if (boxSizing === 'content-box') {\n      height -= padding\n    }\n\n    document.body.removeChild(hiddenTextarea)\n\n    return height\n  }\n\n  return {\n    calculateRowHeight,\n    calculateHeight,\n  }\n}\n"],"names":["SIZING_STYLE","getNodeHeightStyles","node","style","window","getComputedStyle","boxSizing","getPropertyValue","padding","parseFloat","border","styles","map","name","join","lineHeight","parseInt","textarea","useTextareaRowHeight","textarea2","calculateRowHeight","value","calculateHeight","hiddenTextarea","original","document","createElement","setAttribute","placeholder","wrap","getAttribute","removeAttribute","createHiddenTextarea","body","appendChild","height","scrollHeight","removeChild"],"mappings":"AAEA,MAYMA,EAAe,CACnB,iBACA,cACA,cACA,iBACA,cACA,cACA,YACA,iBACA,iBACA,QACA,cACA,eACA,gBACA,eACA,cAGIC,oBAAuBC,IACrB,MAAAC,EAAQC,OAAOC,iBAAiBH,GAE/B,MAAA,CACLI,UACEH,EAAMI,iBAAiB,eACvBJ,EAAMI,iBAAiB,oBACvBJ,EAAMI,iBAAiB,sBACzBC,QACEC,WAAWN,EAAMI,iBAAiB,mBAClCE,WAAWN,EAAMI,iBAAiB,gBACpCG,OACED,WAAWN,EAAMI,iBAAiB,wBAClCE,WAAWN,EAAMI,iBAAiB,qBACpCI,OACEX,EAAaY,KAAIC,GAAQ,GAAGA,KAAQV,EAAMI,iBAAiBM,OAASC,KAAK,KAAO,IAClFC,WACEC,SAASb,EAAMI,iBAAiB,kBAItC,IAAIU,EAAuC,KAE3C,MAkBaC,qBAAwBC,IA0B5B,CACLC,mBA1ByB,IACpBD,EAASE,MAEPpB,oBAAoBkB,EAASE,OAAON,WAFb,EA0B9BO,gBArBsB,KAClB,IAACH,EAASE,MAAgB,OAAA,EAE9B,MAAMf,UAAEA,EAAWE,QAAAA,EAAAE,OAASA,SAAQC,GAAWV,oBAAoBkB,EAASE,OACtEE,EA7BmB,EAACC,EAA+Bb,KACtDM,IACQA,EAAAQ,SAASC,cAAc,aAG3BT,EAAAU,aAAa,QAAShB,EA1DH,oQA2D5BM,EAASI,MAAQG,EAASH,OAASG,EAASI,aAAe,GACrD,MAAAC,EAAOL,EAASM,aAAa,QAQ5B,OANM,OAATD,EACOZ,EAAAU,aAAa,OAAQE,GAE9BZ,EAASc,gBAAgB,QAGpBd,GAckBe,CAAqBb,EAASE,MAAOV,GACnDc,SAAAQ,KAAKC,YAAYX,GAC1B,IAAIY,EAASZ,EAAea,aAUrB,MARW,eAAd9B,EACQ6B,GAAAzB,EACa,gBAAdJ,IACC6B,GAAA3B,GAGHiB,SAAAQ,KAAKI,YAAYd,GAEnBY"}