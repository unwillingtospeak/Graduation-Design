{"version":3,"file":"VaInput.mjs","sources":["../../../../../src/components/va-input/VaInput.vue"],"sourcesContent":["<template>\n  <va-input-wrapper\n    v-bind=\"fieldListeners\"\n    class=\"va-input\"\n    :class=\"$attrs.class\"\n    :style=\"$attrs.style\"\n    :color=\"$props.color\"\n    :readonly=\"$props.readonly\"\n    :disabled=\"$props.disabled\"\n    :success=\"$props.success\"\n    :messages=\"$props.messages\"\n    :error=\"computedError\"\n    :error-messages=\"computedErrorMessages\"\n    :error-count=\"errorCount\"\n    :label=\"$props.label\"\n    :bordered=\"$props.bordered\"\n    :outline=\"$props.outline\"\n    :requiredMark=\"$props.requiredMark\"\n    :focused=\"isFocused\"\n    :counter-value=\"valueLengthComputed\"\n    :max-length=\"$props.maxLength\"\n    @click=\"focus\"\n  >\n    <!-- Simply proxy slots to VaInputWrapper -->\n    <template\n      v-for=\"name in filterSlots\"\n      :key=\"name\"\n      v-slot:[name]=\"slotScope\"\n    >\n      <slot :name=\"name\" v-bind=\"slotScope\" />\n    </template>\n\n    <template #icon=\"slotScope\">\n      <va-icon\n        v-if=\"canBeCleared\"\n        role=\"button\"\n        aria-hidden=\"false\"\n        aria-label=\"reset\"\n        class=\"va-input__icons__reset\"\n        :tabindex=\"tabIndexComputed\"\n        v-bind=\"clearIconProps\"\n        @click.stop=\"reset\"\n        @keydown.enter.stop=\"reset\"\n        @keydown.space.stop=\"reset\"\n      />\n      <va-icon\n        v-if=\"$props.loading\"\n        :color=\"$props.color\"\n        size=\"small\"\n        name=\"loop\"\n        spin=\"counter-clockwise\"\n      />\n      <slot name=\"icon\" v-bind=\"slotScope\" />\n    </template>\n\n    <VaTextarea\n      v-if=\"type === 'textarea' && !$slots.content\"\n      ref=\"input\"\n      v-bind=\"{ ...computedChildAttributes, ...textareaProps, ...inputEvents }\"\n      class=\"va-input__content__input\"\n    />\n\n    <input\n      v-else-if=\"!$slots.content\"\n      ref=\"input\"\n      class=\"va-input__content__input\"\n      v-bind=\"{ ...computedInputAttributes, ...inputEvents }\"\n      :value=\"computedValue\"\n    >\n  </va-input-wrapper>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, InputHTMLAttributes, shallowRef, toRefs } from 'vue'\nimport omit from 'lodash/omit.js'\nimport pick from 'lodash/pick.js'\n\nimport { extractComponentProps, filterComponentProps } from '../../utils/child-props'\n\nimport {\n  useFormProps,\n  useValidation, useValidationProps, useValidationEmits, ValidationProps,\n  useEmitProxy,\n  useClearable, useClearableProps, useClearableEmits,\n  useFocusDeep,\n} from '../../composables'\nimport { useCleave, useCleaveProps } from './hooks/useCleave'\n\nimport type { AnyStringPropType } from '../../types/prop-type'\n\nimport VaInputWrapper from './components/VaInputWrapper/VaInputWrapper.vue'\nimport VaTextarea from './components/VaTextarea/VaTextarea.vue'\nimport VaIcon from '../va-icon/VaIcon.vue'\n\nconst VaTextareaProps = extractComponentProps(VaTextarea)\n\nconst { createEmits: createInputEmits, createListeners: createInputListeners } = useEmitProxy(\n  ['change', 'keyup', 'keypress', 'keydown', 'focus', 'blur'],\n)\n\nconst { createEmits: createFieldEmits, createListeners: createFieldListeners } = useEmitProxy([\n  'click',\n  'click-prepend',\n  'click-append',\n  'click-prepend-inner',\n  'click-append-inner',\n])\n\nexport default defineComponent({\n  name: 'VaInput',\n\n  components: { VaInputWrapper, VaTextarea, VaIcon },\n\n  props: {\n    ...useFormProps,\n    ...useValidationProps as ValidationProps<string>,\n    ...useClearableProps,\n    ...useCleaveProps,\n    ...VaTextareaProps,\n\n    // input\n    placeholder: { type: String, default: '' },\n    tabindex: { type: Number, default: 0 },\n    modelValue: { type: [String, Number], default: '' },\n    label: { type: String, default: '' },\n    type: { type: String as AnyStringPropType<'textarea' | 'text' | 'password'>, default: 'text' },\n    loading: { type: Boolean, default: false },\n    inputClass: { type: String, default: '' },\n    pattern: { type: String },\n    inputmode: { type: String, default: 'text' },\n    ariaLabel: { type: String, default: undefined },\n    counter: { type: Boolean, default: false },\n    maxLength: { type: Number, default: undefined },\n\n    // style\n    color: { type: String, default: 'primary' },\n    outline: { type: Boolean, default: false },\n    bordered: { type: Boolean, default: false },\n    requiredMark: { type: Boolean, default: false },\n  },\n\n  emits: [\n    'update:modelValue',\n    ...useValidationEmits,\n    ...useClearableEmits,\n    ...createInputEmits(),\n    ...createFieldEmits(),\n  ],\n\n  inheritAttrs: false,\n\n  setup (props, { emit, attrs, slots }) {\n    const input = shallowRef<HTMLInputElement | typeof VaTextarea>()\n\n    const isFocused = useFocusDeep()\n\n    const reset = () => {\n      emit('update:modelValue', props.clearValue)\n      emit('clear')\n    }\n\n    const focus = () => {\n      input.value?.focus()\n    }\n\n    const blur = () => {\n      input.value?.blur()\n    }\n\n    const filterSlots = computed(() => {\n      const iconSlot = ['icon']\n      return Object.keys(slots).filter(slot => !iconSlot.includes(slot))\n    })\n\n    const {\n      computedError,\n      computedErrorMessages,\n      listeners: validationListeners,\n      validationAriaAttributes,\n    } = useValidation(props, emit, reset, focus)\n\n    const { modelValue } = toRefs(props)\n    const {\n      canBeCleared,\n      clearIconProps,\n    } = useClearable(props, modelValue, input, computedError)\n\n    /** Use cleave only if this component is input, because it will break. */\n    const computedCleaveTarget = computed(() => props.type === 'textarea'\n      ? undefined\n      : input.value as HTMLInputElement | undefined)\n\n    const { computedValue, onInput } = useCleave(computedCleaveTarget, props, emit)\n\n    const inputListeners = createInputListeners(emit)\n\n    /** Combine EmitProxy events with validation events to avoid events overriding */\n    const onFocus = (e: Event) => {\n      inputListeners.onFocus(e)\n      validationListeners.onFocus()\n    }\n\n    const onBlur = (e: Event) => {\n      inputListeners.onBlur(e)\n      validationListeners.onBlur()\n    }\n\n    const inputEvents = {\n      ...inputListeners,\n      onFocus,\n      onBlur,\n      onInput,\n    }\n\n    const tabIndexComputed = computed(() => props.disabled ? -1 : props.tabindex)\n\n    const computedChildAttributes = computed(() => ({\n      ariaLabel: props.ariaLabel || props.label,\n      ariaRequired: props.requiredMark,\n      tabindex: tabIndexComputed.value,\n      class: props.inputClass,\n      ariaDisabled: props.disabled,\n      ariaReadonly: props.readonly,\n      ...validationAriaAttributes.value,\n      ...omit(attrs, ['class', 'style']),\n    }) as InputHTMLAttributes)\n\n    const computedInputAttributes = computed(() => ({\n      ...computedChildAttributes.value,\n      ...pick(props, ['type', 'disabled', 'readonly', 'placeholder', 'pattern', 'inputmode']),\n    }) as InputHTMLAttributes)\n\n    const valueLengthComputed = computed(() =>\n      props.counter && typeof computedValue.value === 'string' ? computedValue.value.length : undefined,\n    )\n\n    return {\n      input,\n      inputEvents,\n\n      valueLengthComputed,\n      computedChildAttributes,\n      computedInputAttributes,\n      textareaProps: filterComponentProps(props, VaTextareaProps),\n      computedValue,\n      tabIndexComputed,\n\n      // Validations\n      computedError,\n      computedErrorMessages,\n      isFocused,\n\n      // Icon\n      canBeCleared,\n      clearIconProps,\n\n      fieldListeners: createFieldListeners(emit),\n      filterSlots,\n      reset,\n      focus,\n      blur,\n    }\n  },\n})\n</script>\n"],"names":["VaTextareaProps","extractComponentProps","VaTextarea","createEmits","createInputEmits","createListeners","createInputListeners","useEmitProxy","createFieldEmits","createFieldListeners","_sfc_main","defineComponent","name","components","VaInputWrapper","VaIcon","props","__spreadProps","__spreadValues","useFormProps","useValidationProps","useClearableProps","useCleaveProps","placeholder","type","String","default","tabindex","Number","modelValue","label","loading","Boolean","inputClass","pattern","inputmode","ariaLabel","counter","maxLength","color","outline","bordered","requiredMark","emits","useValidationEmits","useClearableEmits","inheritAttrs","setup","emit","attrs","slots","input","shallowRef","isFocused","useFocusDeep","reset","clearValue","focus","_a","value","filterSlots","computed","iconSlot","Object","keys","filter","includes","slot","computedError","computedErrorMessages","listeners","validationListeners","validationAriaAttributes","useValidation","toRefs","canBeCleared","clearIconProps","useClearable","computedCleaveTarget","computedValue","onInput","useCleave","inputListeners","inputEvents","onFocus","e","onBlur","tabIndexComputed","disabled","computedChildAttributes","ariaRequired","class","ariaDisabled","ariaReadonly","readonly","omit","computedInputAttributes","pick","valueLengthComputed","length","textareaProps","filterComponentProps","fieldListeners","blur","_createBlock","_component_va_input_wrapper","_mergeProps","_ctx","$attrs","style","$props","success","messages","error","errorCount","focused","onClick","_createSlots","icon","_withCtx","slotScope","_openBlock","_component_va_icon","key","role","_withModifiers","onKeydown","_withKeys","size","spin","_createCommentVNode","_renderSlot","$slots","content","openBlock","_createElementBlock","ref","_hoisted_1","_component_VaTextarea","_renderList","fn","_normalizeProps","_guardReactiveProps"],"mappings":"uhDA8FA,MAAMA,EAAkBC,EAAsBC,IAEtCC,YAAaC,EAAkBC,gBAAiBC,GAAyBC,EAC/E,CAAC,SAAU,QAAS,WAAY,UAAW,QAAS,UAG9CJ,YAAaK,EAAkBH,gBAAiBI,GAAyBF,EAAa,CAC5F,QACA,gBACA,eACA,sBACA,uBAGGG,EAAaC,EAAa,CAC7BC,KAAM,UAENC,WAAY,CAAEC,eAAAA,EAAgBZ,WAAAA,EAAYa,OAAAA,GAE1CC,MAAOC,cACFC,eAAAA,eAAAA,eAAAA,eAAAA,eAAA,GAAAC,GACAC,GACAC,GACAC,GACAtB,GALE,CAQLuB,YAAa,CAAEC,KAAMC,OAAQC,QAAS,IACtCC,SAAU,CAAEH,KAAMI,OAAQF,QAAS,GACnCG,WAAY,CAAEL,KAAM,CAACC,OAAQG,QAASF,QAAS,IAC/CI,MAAO,CAAEN,KAAMC,OAAQC,QAAS,IAChCF,KAAM,CAAEA,KAAMC,OAA+DC,QAAS,QACtFK,QAAS,CAAEP,KAAMQ,QAASN,SAAS,GACnCO,WAAY,CAAET,KAAMC,OAAQC,QAAS,IACrCQ,QAAS,CAAEV,KAAMC,QACjBU,UAAW,CAAEX,KAAMC,OAAQC,QAAS,QACpCU,UAAW,CAAEZ,KAAMC,OAAQC,aAAS,GACpCW,QAAS,CAAEb,KAAMQ,QAASN,SAAS,GACnCY,UAAW,CAAEd,KAAMI,OAAQF,aAAS,GAGpCa,MAAO,CAAEf,KAAMC,OAAQC,QAAS,WAChCc,QAAS,CAAEhB,KAAMQ,QAASN,SAAS,GACnCe,SAAU,CAAEjB,KAAMQ,QAASN,SAAS,GACpCgB,aAAc,CAAElB,KAAMQ,QAASN,SAAS,KAG1CiB,MAAO,CACL,uBACGC,KACAC,KACAzC,OACAI,KAGLsC,cAAc,EAEdC,MAAO/B,GAAOgC,KAAEA,EAAAC,MAAMA,QAAOC,IAC3B,MAAMC,EAAQC,IAERC,EAAYC,IAEZC,MAAQ,KACPP,EAAA,oBAAqBhC,EAAMwC,YAChCR,EAAK,UAGDS,MAAQ,WACZ,OAAAC,EAAAP,EAAMQ,QAAOD,EAAAD,SAOTG,EAAcC,GAAS,KACrB,MAAAC,EAAW,CAAC,QACX,OAAAC,OAAOC,KAAKd,GAAOe,YAAgBH,EAASI,SAASC,SAGxDC,cACJA,EAAAC,sBACAA,EACAC,UAAWC,EAAAC,yBACXA,GACEC,EAAczD,EAAOgC,EAAMO,MAAOE,QAEhC5B,WAAEA,GAAe6C,EAAO1D,IACxB2D,aACJA,EAAAC,eACAA,GACEC,EAAa7D,EAAOa,EAAYsB,EAAOiB,GAGrCU,EAAuBjB,GAAS,IAAqB,aAAf7C,EAAMQ,UAC9C,EACA2B,EAAMQ,SAEJoB,cAAEA,EAAeC,QAAAA,GAAYC,EAAUH,EAAsB9D,EAAOgC,GAEpEkC,EAAiB5E,EAAqB0C,GAatCmC,EAAclE,gCACfiE,GADe,CAElBE,QAZeC,IACfH,EAAeE,QAAQC,GACvBd,EAAoBa,WAWpBE,OARcD,IACdH,EAAeI,OAAOD,GACtBd,EAAoBe,UAOpBN,QAAAA,IAGIO,EAAmB1B,GAAS,IAAM7C,EAAMwE,UAAW,EAAKxE,EAAMW,WAE9D8D,EAA0B5B,GAAS,IAAO3C,eAAAA,eAAA,CAC9CkB,UAAWpB,EAAMoB,WAAapB,EAAMc,MACpC4D,aAAc1E,EAAM0B,aACpBf,SAAU4D,EAAiB5B,MAC3BgC,MAAO3E,EAAMiB,WACb2D,aAAc5E,EAAMwE,SACpBK,aAAc7E,EAAM8E,UACjBtB,EAAyBb,OACzBoC,EAAK9C,EAAO,CAAC,QAAS,aAGrB+C,EAA0BnC,GAAS,IAAO3C,eAC3CA,eAAA,GAAAuE,EAAwB9B,OACxBsC,EAAKjF,EAAO,CAAC,OAAQ,WAAY,WAAY,cAAe,UAAW,iBAGtEkF,EAAsBrC,GAAS,IACnC7C,EAAMqB,SAA0C,iBAAxB0C,EAAcpB,MAAqBoB,EAAcpB,MAAMwC,YAAS,IAGnF,MAAA,CACLhD,MAAAA,EACAgC,YAAAA,EAEAe,oBAAAA,EACAT,wBAAAA,EACAO,wBAAAA,EACAI,cAAeC,EAAqBrF,EAAOhB,GAC3C+E,cAAAA,EACAQ,iBAAAA,EAGAnB,cAAAA,EACAC,sBAAAA,EACAhB,UAAAA,EAGAsB,aAAAA,EACAC,eAAAA,EAEA0B,eAAgB7F,EAAqBuC,GACrCY,YAAAA,EACAL,MAAAA,MACAE,MAAAA,MACA8C,KA/FW,WACX,OAAA7C,EAAAP,EAAMQ,QAAOD,EAAA6C,yJArKjBC,EAoEmBC,EApEnBC,EACUC,EAmESL,eAnEK,CACtBX,MAAK,CAAC,WACEgB,EAAAC,OAAOjB,OACdkB,MAAOF,EAAOC,OAAAC,MACdtE,MAAOoE,EAAOG,OAAAvE,MACduD,SAAUa,EAAOG,OAAAhB,SACjBN,SAAUmB,EAAOG,OAAAtB,SACjBuB,QAASJ,EAAOG,OAAAC,QAChBC,SAAUL,EAAOG,OAAAE,SACjBC,MAAON,EAAAvC,cACP,iBAAgBuC,EAAAtC,sBAChB,cAAasC,EAAAO,WACbpF,MAAO6E,EAAOG,OAAAhF,MACdW,SAAUkE,EAAOG,OAAArE,SACjBD,QAASmE,EAAOG,OAAAtE,QAChBE,aAAciE,EAAOG,OAAApE,aACrByE,QAASR,EAAAtD,UACT,gBAAesD,EAAAT,oBACf,aAAYS,EAAOG,OAAAxE,UACnB8E,QAAOT,EAAAlD,QAAA4D,EAAA,CAWGC,KAAIC,GAAEC,GAAS,CAEhBb,EAAAhC,cAAA8C,IADRjB,EAWEkB,EAXFhB,EAWE,CAAAiB,IAAA,EATAC,KAAK,SACL,cAAY,QACZ,aAAW,QACXjC,MAAM,yBACLhE,SAAUgF,EAAApB,kBACHoB,EAAc/B,eAAA,CACrBwC,QAAKS,EAAOlB,EAAKpD,MAAA,CAAA,SACjBuE,UAAO,CAAAC,EAAAF,EAAalB,EAAKpD,MAAA,CAAA,SAAA,CAAA,UAAAwE,EAAAF,EACLlB,EAAKpD,MAAA,CAAA,SAAA,CAAA,mEAGpBoD,EAAAG,OAAO/E,aADfyE,EAMEkB,EAAA,CAAAC,IAAA,EAJCpF,MAAOoE,EAAOG,OAAAvE,MACfyF,KAAK,QACLpH,KAAK,OACLqH,KAAK,qBAAA,KAAA,EAAA,CAAA,WAAAC,EAAA,IAAA,GAEPC,EAAuCxB,oBAAba,mBAG5B,IAKE,CAJU,aAAJb,QAAwBA,EAAAyB,OAAOC,QAOzB1B,EAAOyB,OAAAC,QAIEH,EAAA,IAAA,IAJFI,IADrBC,EAMC,QAND7B,EAMC,CAAAiB,IAAA,EAJCa,IAAI,QACJ7C,MAAM,4BAAAzE,eACOA,eAAA,GAAAyF,EAA4BX,yBAAAW,EAAAxB,aACxC,CAAAxB,MAAOgD,EAAa5B,gBAAA,KAAA,GAAA0D,KAZvBH,IAAA9B,EAKEkC,EALFhC,EAKE,CAAAiB,IAAA,EAHAa,IAAI,SACStH,eAAAA,eAAAA,eAAA,GAAAyF,EAAAlB,yBAA4BkB,EAAkBP,eAAAO,EAAAxB,aAC3D,CAAAQ,MAAM,6BAA0B,KAAA,cAlCjBgD,EAAAhC,EAAA/C,aAARhD,YAIPgI,GAAArB,GAFeC,GAAS,CAExBW,EAAwCxB,EAAAyB,OAA3BxH,EAAIiI,EAAAC,EAAUtB"}