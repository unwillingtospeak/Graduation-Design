{"version":3,"file":"use-picker.mjs","sources":["../../../../../../src/components/va-date-picker/hooks/use-picker.ts"],"sourcesContent":["import { computed, ComputedRef, ref, watch } from 'vue'\n\nimport { isDatesMonthEqual, isDatesDayEqual, isDatesYearEqual, isDates, isRange, isSingleDate } from './../utils/date-utils'\nimport { useDatePickerModelValue } from './model-value-helper'\nimport { DatePickerMode, DatePickerModelValue, DatePickerType } from '../types'\n\nconst getDateEqualFunction = (type: DatePickerType) => {\n  return {\n    month: isDatesMonthEqual,\n    day: isDatesDayEqual,\n    year: isDatesYearEqual,\n  }[type]\n}\n\nexport const useDatePicker = (\n  type: DatePickerType,\n  dates: ComputedRef<Date[]>,\n  props: {\n    modelValue?: DatePickerModelValue,\n    mode: DatePickerMode,\n    readonly: boolean,\n    allowedDays?: (date: Date) => boolean,\n    allowedMonths?: (date: Date) => boolean,\n    allowedYears?: (date: Date) => boolean,\n  },\n  emit: (event: 'update:modelValue' | any, ...args: any[]) => void,\n) => {\n  const datesEqual = getDateEqualFunction(type)\n  const isAllowedDate = props.allowedDays || props.allowedMonths || props.allowedYears\n  const isDateDisabled = (date: Date) => isAllowedDate === undefined ? false : !isAllowedDate(date)\n\n  const hoveredIndex = ref(-1)\n  const hoveredValue = computed(() => dates.value[hoveredIndex.value])\n\n  const { updateModelValue } = useDatePickerModelValue(\n    props,\n    emit,\n    datesEqual,\n  )\n\n  const onClick = (date: Date) => {\n    if (props.readonly || isDateDisabled(date)) { return }\n\n    updateModelValue(date)\n    emit(`click:${type}`, date)\n  }\n\n  const isToday = (date: Date): boolean => {\n    const today = new Date()\n    return datesEqual(today, date)\n  }\n\n  const isSelected = (date: Date): boolean => {\n    if (!props.modelValue) { return false }\n\n    if (isSingleDate(props.modelValue)) {\n      return datesEqual(props.modelValue, date)\n    } else if (isDates(props.modelValue)) {\n      return !!props.modelValue.find((d) => datesEqual(d, date))\n    } else if (isRange(props.modelValue)) {\n      return datesEqual(props.modelValue.start, date) || datesEqual(props.modelValue.end, date)\n    }\n\n    return false\n  }\n\n  const isInRange = (date: Date): boolean => {\n    if (!props.modelValue) { return false }\n\n    if (!isRange(props.modelValue)) { return false }\n\n    if (props.modelValue.start && props.modelValue.end) {\n      return props.modelValue.start < date && props.modelValue.end > date\n    }\n\n    const selectedDate = props.modelValue.start || props.modelValue.end\n\n    if (selectedDate) {\n      if (!hoveredValue.value) { return false }\n\n      return selectedDate < date\n        ? (hoveredValue.value >= date)\n        : (hoveredValue.value <= date)\n    }\n\n    return false\n  }\n\n  watch(hoveredValue, (date) => { emit(`hover:${type}`, date) })\n\n  return {\n    hoveredIndex,\n    hoveredValue,\n    onClick,\n    isToday,\n    isSelected,\n    isInRange,\n  }\n}\n"],"names":["useDatePicker","type","dates","props","emit","datesEqual","month","isDatesMonthEqual","day","isDatesDayEqual","year","isDatesYearEqual","getDateEqualFunction","isAllowedDate","allowedDays","allowedMonths","allowedYears","hoveredIndex","ref","hoveredValue","computed","value","updateModelValue","useDatePickerModelValue","watch","date","onClick","readonly","isDateDisabled","isToday","today","Date","isSelected","modelValue","isSingleDate","isDates","find","d","isRange","start","end","isInRange","selectedDate"],"mappings":"+KAMA,MAQaA,cAAgB,CAC3BC,EACAC,EACAC,EAQAC,KAEM,MAAAC,EArBqB,CAACJ,IACrB,CACLK,MAAOC,EACPC,IAAKC,EACLC,KAAMC,GACNV,IAgBiBW,CAAqBX,GAClCY,EAAgBV,EAAMW,aAAeX,EAAMY,eAAiBZ,EAAMa,aAGlEC,EAAeC,GAAM,GACrBC,EAAeC,GAAS,IAAMlB,EAAMmB,MAAMJ,EAAaI,UAEvDC,iBAAEA,GAAqBC,EAC3BpB,EACAC,EACAC,GAqDK,OAFDmB,EAAAL,GAAeM,IAAgBrB,EAAA,SAASH,IAAQwB,MAE/C,CACLR,aAAAA,EACAE,aAAAA,EACAO,QArDeD,IACXtB,EAAMwB,UAZW,CAACF,QAAiC,IAAlBZ,IAAuCA,EAAcY,GAYpEG,CAAeH,KAErCH,EAAiBG,GACZrB,EAAA,SAASH,IAAQwB,KAkDtBI,QA/CeJ,IACT,MAAAK,EAAQ,IAAIC,KACX,OAAA1B,EAAWyB,EAAOL,IA8CzBO,WA3CkBP,KACbtB,EAAM8B,aAEPC,EAAa/B,EAAM8B,YACd5B,EAAWF,EAAM8B,WAAYR,GAC3BU,EAAQhC,EAAM8B,cACd9B,EAAM8B,WAAWG,MAAMC,GAAMhC,EAAWgC,EAAGZ,OAC3Ca,EAAQnC,EAAM8B,cAChB5B,EAAWF,EAAM8B,WAAWM,MAAOd,IAASpB,EAAWF,EAAM8B,WAAWO,IAAKf,KAoCtFgB,UA9BiBhB,IACb,IAACtB,EAAM8B,WAAqB,OAAA,EAEhC,IAAKK,EAAQnC,EAAM8B,YAAsB,OAAA,EAEzC,GAAI9B,EAAM8B,WAAWM,OAASpC,EAAM8B,WAAWO,IAC7C,OAAOrC,EAAM8B,WAAWM,MAAQd,GAAQtB,EAAM8B,WAAWO,IAAMf,EAGjE,MAAMiB,EAAevC,EAAM8B,WAAWM,OAASpC,EAAM8B,WAAWO,IAEhE,QAAIE,MACGvB,EAAaE,QAEXqB,EAAejB,EACjBN,EAAaE,OAASI,EACtBN,EAAaE,OAASI"}