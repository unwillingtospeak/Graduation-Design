var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,__defNormalProp=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r;import{defineComponent as s,shallowRef as i,ref as n,computed as u,onMounted as v,onBeforeUnmount as d,watch as c,resolveComponent as m,openBlock as p,createElementBlock as y,mergeProps as b,renderSlot as f,createCommentVNode as A,normalizeStyle as k,createTextVNode as g,toDisplayString as _,createVNode as h,createElementVNode as C,Fragment as w,renderList as L,normalizeClass as V,normalizeProps as x,guardReactiveProps as S}from"vue";import{p as $}from"../../../vendor.mjs";import{g as O}from"../../services/utils.mjs";import{u as B}from"../../composables/useArrayRefs.mjs";import{u as D}from"../../composables/useBem.mjs";import{u as E}from"../../composables/useColors.mjs";import"../../composables/useDropdown.mjs";import{v as j}from"./validateSlider.mjs";import{V as P}from"../va-icon/index.mjs";import{_ as I}from"../../../plugin-vue_export-helper.mjs";const F=s({name:"VaSlider",components:{VaIcon:P},emits:["drag-start","drag-end","change","update:modelValue"],props:{range:{type:Boolean,default:!1},modelValue:{type:[Number,Array],default:0},trackLabel:{type:[Function,String]},color:{type:String,default:"primary"},trackColor:{type:String,default:""},labelColor:{type:String,default:""},trackLabelVisible:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},label:{type:String,default:""},invertLabel:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},pins:{type:Boolean,default:!1},iconPrepend:{type:String,default:""},iconAppend:{type:String,default:""},vertical:{type:Boolean,default:!1},showTrack:{type:Boolean,default:!0}},setup(e,{emit:s,slots:m}){const{getColor:p,getHoverColor:y}=E(),b=i(),f=i(),{setItemRefByIndex:A,itemRefs:k}=B(),g=n(!1),_=n(!1),h=n(0),C=n(0),w=n(Array.isArray(e.modelValue)?[...e.modelValue]:e.modelValue),L=n(0),V=n(!1),x=u((()=>e.vertical?[1,0]:[0,1])),S=u((()=>e.vertical?"bottom":"left")),P=u((()=>e.vertical?"height":"width")),I=u((()=>Array.isArray(H.value)&&H.value[1]-e.step<H.value[0])),F=u((()=>Array.isArray(H.value)&&H.value[0]+e.step>H.value[1])),R=D("va-slider",(()=>{return s=((e,a)=>{for(var l in a||(a={}))t.call(a,l)&&__defNormalProp(e,l,a[l]);if(r)for(var l of r(a))o.call(a,l)&&__defNormalProp(e,l,a[l]);return e})({},$(e,["disabled","readonly","vertical"])),i={active:g.value,horizontal:!e.vertical,grabbing:V.value},a(s,l(i));var s,i})),M=D("va-slider__handler",(()=>({onFocus:!e.range&&(_.value||g.value),inactive:!g.value}))),T=u((()=>({color:e.labelColor?p(e.labelColor):p(e.color)}))),N=u((()=>({backgroundColor:e.trackColor?p(e.trackColor):y(p(e.color))}))),z=u((()=>{const a=limitValue(e.modelValue);if(Array.isArray(a)){const l=(a[0]-e.min)/(e.max-e.min)*100,r=(a[1]-e.min)/(e.max-e.min)*100;return{[S.value]:`${l}%`,[P.value]:r-l+"%",backgroundColor:p(e.color),visibility:e.showTrack?"visible":"hidden"}}{const l=(a-e.min)/(e.max-e.min)*100;return{[P.value]:`${l}%`,backgroundColor:p(e.color),visibility:e.showTrack?"visible":"hidden"}}})),U=u((()=>{const a=limitValue(e.modelValue);if(Array.isArray(a)){const l=(a[0]-e.min)/(e.max-e.min)*100,r=(a[1]-e.min)/(e.max-e.min)*100;return[{[S.value]:`${l}%`,backgroundColor:isActiveDot(0)?p(e.color):"#ffffff",borderColor:p(e.color)},{[S.value]:`${r}%`,backgroundColor:isActiveDot(1)?p(e.color):"#ffffff",borderColor:p(e.color)}]}{const l=(a-e.min)/(e.max-e.min)*100;return{[S.value]:`${l}%`,backgroundColor:isActiveDot(0)?p(e.color):"#ffffff",borderColor:p(e.color)}}})),H=u({get:()=>e.modelValue,set:a=>{e.range||(a=limitValue(a)),_.value||s("change",a),s("update:modelValue",a)}}),J=u((()=>{const a=(e.max-e.min)/e.step;return C.value/a})),W=u((()=>{const a=`${e.step}`.split(".")[1];return a?Math.pow(10,a.length):1})),X=u((()=>(e.max-e.min)/e.step-1)),Y=u((()=>Array.isArray(e.modelValue)?[(e.modelValue[0]-e.min)/e.step*J.value,(e.modelValue[1]-e.min)/e.step*J.value]:(e.modelValue-e.min)/e.step*J.value)),q=u((()=>[0,C.value])),G=u((()=>[e.min,e.max])),isActiveDot=a=>!(!g.value&&!_.value||e.disabled||e.readonly)&&(e.range?L.value===a:0===L.value),moving=a=>{V.value&&_.value&&!e.disabled&&!e.readonly&&(a.preventDefault(),setValueOnPos(getPos("touches"in a?a.touches[0]:a)))},moveEnd=()=>{if(!e.disabled&&!e.readonly){if(!_.value)return!1;s("drag-end"),s("change",e.modelValue),_.value=!1,V.value=!1}},moveWithKeys=a=>{var l,r;if(![k.value[0],k.value[1],f.value].includes(document.activeElement))return;if(e.disabled||e.readonly)return;const moveDot=(a,l,r)=>{if(a&&Array.isArray(H.value)){if(!e.pins)return H.value.splice(r,1,H.value[r]+(l?e.step:-e.step));const a=(e.max-e.min)/(X.value+1);let t=(H.value[r]/a|0)*a;H.value[r]!==t?(t+=l?a:0,H.value.splice(r,1,t)):H.value.splice(r,1,H.value[r]+(l?e.step:-e.step))}else{if(!e.pins&&!Array.isArray(H.value))return void(H.value+=l?e.step:-e.step);const a=(e.max-e.min)/(X.value+1);let r=(Array.isArray(H.value)?0:H.value/a|0)*a;H.value!==r?(r+=l?a:0,H.value=r):H.value+=l?e.step:-e.step}};["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(a.key)&&a.preventDefault();const isActive=e=>e===document.activeElement;if(e.range&&Array.isArray(H.value)){const isVerticalDot0More=a=>e.vertical&&isActive(k.value[0])&&"ArrowUp"===a.key,isVerticalDot0Less=a=>e.vertical&&isActive(k.value[0])&&"ArrowDown"===a.key,isVerticalDot1More=a=>e.vertical&&isActive(k.value[1])&&"ArrowUp"===a.key,isVerticalDot1Less=a=>e.vertical&&isActive(k.value[1])&&"ArrowDown"===a.key,isHorizontalDot0Less=a=>!e.vertical&&isActive(k.value[0])&&"ArrowLeft"===a.key,isHorizontalDot0More=a=>!e.vertical&&isActive(k.value[0])&&"ArrowRight"===a.key,isHorizontalDot1Less=a=>!e.vertical&&isActive(k.value[1])&&"ArrowLeft"===a.key,isHorizontalDot1More=a=>!e.vertical&&isActive(k.value[1])&&"ArrowRight"===a.key;switch(!0){case(isVerticalDot1Less(a)||isHorizontalDot1Less(a))&&I.value&&H.value[0]!==e.min:null==(l=k.value[0])||l.focus(),moveDot(!0,0,0);break;case(isVerticalDot0More(a)||isHorizontalDot0More(a))&&F.value&&H.value[1]!==e.max:null==(r=k.value[1])||r.focus(),moveDot(!0,1,1);break;case(isVerticalDot0Less(a)||isHorizontalDot0Less(a))&&H.value[0]!==e.min:moveDot(!0,0,0);break;case(isVerticalDot1More(a)||isHorizontalDot1More(a))&&H.value[1]!==e.max:moveDot(!0,1,1);break;case(isVerticalDot1Less(a)||isHorizontalDot1Less(a))&&H.value[1]!==e.min:moveDot(!0,0,1);break;case(isVerticalDot0More(a)||isHorizontalDot0More(a))&&H.value[0]!==e.max:moveDot(!0,1,0)}}else e.vertical?("ArrowDown"===a.key&&moveDot(!1,0,0),"ArrowUp"===a.key&&moveDot(!1,1,0)):("ArrowLeft"===a.key&&moveDot(!1,0,0),"ArrowRight"===a.key&&moveDot(!1,1,0))},checkActivePin=a=>Array.isArray(H.value)?a*e.step>H.value[0]&&a*e.step<H.value[1]:a*e.step<H.value,K=u((()=>e.step/(e.max-e.min)*100)),getPos=a=>(getStaticData(),e.vertical?h.value-a.clientY:a.clientX-h.value),getStaticData=()=>{b.value&&(C.value=b.value[e.vertical?"offsetHeight":"offsetWidth"],h.value=b.value.getBoundingClientRect()[S.value])},getValueByIndex=a=>(e.step*W.value*a+e.min*W.value)/W.value,setCurrentValue=a=>{const l=L.value;if(Array.isArray(H.value)&&Array.isArray(w.value)&&Array.isArray(e.modelValue))isDiff(w.value[l],a)&&(w.value.splice(l,1,a),0===l?(H.value=[w.value.splice(l,1,a)[0],e.modelValue[1]],w.value=[...H.value]):(H.value=[e.modelValue[0],w.value.splice(l,1,a)[0]],w.value=[...H.value]));else{if(a<e.min||a>e.max)return!1;isDiff(w.value,a)&&(w.value=a,H.value=a)}},setValueOnPos=a=>{const l=q.value,r=G.value,t=Array.isArray(e.modelValue)?k.value[L.value]:f.value;if(null==t||t.focus(),a>=l[0]&&a<=l[1])if(L.value){Array.isArray(Y.value)&&Array.isArray(H.value)&&a<=Y.value[0]&&(H.value[1]=H.value[0],L.value=0);const e=getValueByIndex(Math.round(a/J.value));setCurrentValue(e)}else{Array.isArray(Y.value)&&Array.isArray(H.value)&&a>=Y.value[1]&&(H.value[0]=H.value[1],L.value=1);const e=getValueByIndex(Math.round(a/J.value));setCurrentValue(e)}else a<l[0]?setCurrentValue(r[0]):setCurrentValue(r[1])},limitValue=a=>{const inRange=a=>a<e.min?e.min:a>e.max?e.max:a;if(Array.isArray(a)){if(a[0]>=a[1]&&0===L.value){const e=inRange(a[1]);return[e,e]}if(a[0]>=a[1]&&1===L.value){const e=inRange(a[0]);return[e,e]}return a.map((e=>inRange(e)))}return inRange(a)},isDiff=(e,a)=>JSON.stringify(e)!==JSON.stringify(a),Q=u((()=>`aria-label-id-${O()}`)),Z=u((()=>({role:"slider","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-label":m.label||e.label?void 0:`current slider value is ${String(e.modelValue)}`,"aria-labelledby":m.label||e.label?Q.value:void 0,ariaOrientation:e.vertical?"vertical":"horizontal",ariaDisabled:e.disabled,"aria-readonly":e.readonly,"aria-valuenow":Array.isArray(e.modelValue)?void 0:e.modelValue,"aria-valuetext":Array.isArray(e.modelValue)?String(e.modelValue):void 0})));return v((()=>{j(e.modelValue,e.step,e.min,e.max,e.range)&&(getStaticData(),document.addEventListener("mousemove",moving),document.addEventListener("touchmove",moving,{passive:!1}),document.addEventListener("mouseup",moveEnd),document.addEventListener("mouseleave",moveEnd),document.addEventListener("touchcancel",moveEnd),document.addEventListener("touchend",moveEnd),document.addEventListener("keydown",moveWithKeys))})),d((()=>{document.removeEventListener("mousemove",moving),document.removeEventListener("touchmove",moving),document.removeEventListener("mouseup",moveEnd),document.removeEventListener("mouseleave",moveEnd),document.removeEventListener("touchcancel",moveEnd),document.removeEventListener("touchend",moveEnd),document.removeEventListener("keydown",moveWithKeys)})),c([H,()=>e.step,()=>e.min,()=>e.max,()=>e.range],(([e,a,l,r,t])=>{j(e)})),c(V,(e=>{document.documentElement.style.cursor=e?"grabbing":""})),{getColor:p,dot:f,dots:k,setItemRefByIndex:A,orders:x,sliderContainer:b,val:H,getValueByOrder:a=>e.range&&void 0!==a?H.value[a]:H.value,sliderClass:R,dotClass:M,labelStyles:T,processedStyles:z,getPinStyles:a=>({backgroundColor:checkActivePin(a)?p(e.color):y(p(e.color)),[S.value]:a*K.value+"%",transition:V.value?"none":"var(--va-slider-pin-transition)"}),dottedStyles:U,getDottedStyles:a=>e.range&&void 0!==a?U.value[a]:U.value,clickOnContainer:a=>{if(e.disabled||e.readonly)return;const l=getPos("touches"in a?a.touches[0]:a);Array.isArray(Y.value)&&(L.value=l>(Y.value[1]-Y.value[0])/2+Y.value[0]?1:0),V.value=!0,setValueOnPos(l),((a,l=L.value)=>{var r,t;if(a.preventDefault(),!l)if(e.range){if(Array.isArray(Y.value)){const e="touches"in a?a.touches[0]:a;l=getPos(e)>(Y.value[1]-Y.value[0])/2+Y.value[0]?1:0}}else l=0;Array.isArray(e.modelValue)&&(L.value=l),Array.isArray(e.modelValue)?null==(r=k.value[l])||r.focus():null==(t=f.value)||t.focus(),_.value=!0,s("drag-start")})(a,L.value)},hasMouseDown:V,trackStyles:N,pinsCol:X,checkActivePin:checkActivePin,isFocused:g,isActiveDot:isActiveDot,getTrackLabel:(a,l)=>e.trackLabel?"function"==typeof e.trackLabel?e.trackLabel(a,l):e.trackLabel:a,currentSliderDotIndex:L,ariaLabelIdComputed:Q,ariaAttributesComputed:Z}}}),R={key:0,class:"va-slider__input-wrapper","aria-hidden":"true"},M=["id"],T={key:2,class:"va-input__label","aria-hidden":"true"},N=["tabindex","onFocus"],z=["tabindex"],U={key:3,class:"va-input__label--inverse","aria-hidden":"true"},H=["id"],J={key:5,class:"va-slider__input-wrapper"};var W=I(F,[["render",function _sfc_render(e,a,l,r,t,o){const s=m("va-icon");return p(),y("div",b({class:["va-slider",e.sliderClass]},e.ariaAttributesComputed),[(e.vertical?e.$slots.append:e.$slots.prepend)?(p(),y("div",R,[f(e.$slots,e.vertical?"append":"prepend")])):A("",!0),!e.$slots.label&&!e.label||e.invertLabel?A("",!0):(p(),y("span",{key:1,class:"va-input__label",id:e.ariaLabelIdComputed,style:k(e.labelStyles)},[f(e.$slots,"label",{},(()=>[g(_(e.label),1)]))],12,M)),(e.vertical?e.iconAppend:e.iconPrepend)?(p(),y("span",T,[h(s,{name:e.vertical?e.iconAppend:e.iconPrepend,color:e.getColor(e.$props.color),size:16},null,8,["name","color"])])):A("",!0),C("div",{ref:"sliderContainer",class:"va-slider__container",onMousedown:a[3]||(a[3]=(...a)=>e.clickOnContainer&&e.clickOnContainer(...a)),onMouseup:a[4]||(a[4]=a=>e.hasMouseDown=!1),onTouchstart:a[5]||(a[5]=(...a)=>e.clickOnContainer&&e.clickOnContainer(...a))},[C("div",{class:"va-slider__track","aria-hidden":"true",style:k(e.trackStyles)},null,4),e.pins?(p(!0),y(w,{key:0},L(e.pinsCol,((a,l)=>(p(),y("div",{key:l,class:V(["va-slider__mark",{"va-slider__mark--active":e.checkActivePin(a)}]),style:k(e.getPinStyles(a))},null,6)))),128)):A("",!0),e.$props.range?(p(),y(w,{key:1},[C("div",{ref:"process",class:V(["va-slider__track va-slider__track--selected",{"va-slider__track--active":e.isFocused}]),"aria-hidden":"true",style:k(e.processedStyles)},null,6),(p(!0),y(w,null,L(e.orders,(l=>(p(),y("div",{key:"dot"+l,ref_for:!0,ref:e.setItemRefByIndex(l),class:V(["va-slider__handler",e.dotClass]),style:k(e.getDottedStyles(l)),tabindex:e.disabled||e.readonly?void 0:0,onFocus:a=>(e.isFocused=!0,e.currentSliderDotIndex=l),onBlur:a[0]||(a[0]=a=>e.isFocused=!1)},[e.isActiveDot(l)?(p(),y("div",{key:0,style:k({backgroundColor:e.getColor(e.$props.color)}),class:"va-slider__handler__dot--focus"},null,4)):A("",!0),e.trackLabelVisible?(p(),y("div",{key:1,style:k(e.labelStyles),class:"va-slider__handler__dot--value"},[f(e.$slots,"trackLabel",x(S({value:e.getValueByOrder(l),order:l})),(()=>[g(_(e.getTrackLabel(e.getValueByOrder(l),l)),1)]))],4)):A("",!0)],46,N)))),128))],64)):(p(),y(w,{key:2},[C("div",{ref:"process","aria-hidden":"true",class:V(["va-slider__track va-slider__track--selected",{"va-slider__track--active":e.isFocused}]),style:k(e.processedStyles)},null,6),C("div",{ref:"dot",class:V(["va-slider__handler",e.dotClass]),style:k(e.dottedStyles),tabindex:e.$props.disabled||e.$props.readonly?void 0:0,onFocus:a[1]||(a[1]=a=>e.isFocused=!0),onBlur:a[2]||(a[2]=a=>e.isFocused=!1)},[e.isActiveDot(0)?(p(),y("div",{key:0,class:"va-slider__handler__dot--focus",style:k({backgroundColor:e.getColor(e.$props.color)})},null,4)):A("",!0),e.trackLabelVisible?(p(),y("div",{key:1,class:"va-slider__handler__dot--value",style:k(e.labelStyles)},[f(e.$slots,"trackLabel",x(S({value:e.getValueByOrder()})),(()=>[g(_(e.getTrackLabel(e.getValueByOrder())),1)]))],4)):A("",!0)],46,z)],64))],544),(e.vertical?e.iconPrepend:e.iconAppend)?(p(),y("span",U,[h(s,{name:e.vertical?e.iconPrepend:e.iconAppend,color:e.getColor(e.$props.color),size:16},null,8,["name","color"])])):A("",!0),(e.$slots.label||e.label)&&e.invertLabel?(p(),y("span",{key:4,class:"va-input__label va-input__label--inverse",style:k(e.labelStyles),id:e.ariaLabelIdComputed},[f(e.$slots,"label",{},(()=>[g(_(e.label),1)]))],12,H)):A("",!0),(e.vertical?e.$slots.prepend:e.$slots.append)?(p(),y("div",J,[f(e.$slots,e.vertical?"prepend":"append")])):A("",!0)],16)}]]);export{W as _};

import './VaSlider.css';
//# sourceMappingURL=VaSlider.mjs.map
