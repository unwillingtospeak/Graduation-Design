import{defineComponent as e,shallowRef as i,ref as o,computed as a,onMounted as t,provide as l,toRef as d,resolveComponent as r,openBlock as n,createElementBlock as s,normalizeClass as m,normalizeStyle as p,renderSlot as u,createElementVNode as v,toDisplayString as c,createCommentVNode as f,createVNode as x,withCtx as j,createTextVNode as g,createBlock as y}from"vue";import{u as b}from"../../composables/useBem.mjs";import{u as h}from"../../composables/useColors.mjs";import"../../../vendor.mjs";import"../../composables/useDropdown.mjs";import{V}from"./types.mjs";import"../va-accordion/index.mjs";import"../va-affix/index.mjs";import"../va-alert/index.mjs";import"../va-app-bar/index.mjs";import"../va-avatar/index.mjs";import"../va-backtop/index.mjs";import"../va-badge/index.mjs";import"../va-breadcrumbs/index.mjs";import"../va-button-dropdown/index.mjs";import"../va-button-group/index.mjs";import"../va-button-toggle/index.mjs";import{V as F}from"../va-button/index.mjs";import"../va-card/index.mjs";import"../va-carousel/index.mjs";import"../va-checkbox/index.mjs";import"../va-chip/index.mjs";import"../va-collapse/index.mjs";import"../va-color-indicator/index.mjs";import"../va-color-input/index.mjs";import"../va-color-palette/index.mjs";import"../va-config/VaConfig.mjs";import"../va-content/index.mjs";import"../va-counter/index.mjs";import"../va-data-table/index.mjs";import"../va-date-input/index.mjs";import"../va-date-picker/index.mjs";import"../va-divider/index.mjs";import"../va-dropdown/index.mjs";import"./index.mjs";import"../va-form/index.mjs";import"../va-hover/index.mjs";import"../va-icon/index.mjs";import"../va-image/index.mjs";import"../va-infinite-scroll/index.mjs";import"../va-inner-loading/index.mjs";import"../va-input/index.mjs";import"../va-list/index.mjs";import{V as _}from"../va-modal/VaModal.mjs";import"../va-navbar/index.mjs";import"../va-option-list/index.mjs";import"../va-pagination/index.mjs";import"../va-parallax/index.mjs";import"../va-popover/index.mjs";import"../va-progress-bar/index.mjs";import"../va-progress-circle/index.mjs";import"../va-radio/index.mjs";import"../va-rating/index.mjs";import"../va-select/index.mjs";import"../va-separator/VaSeparator.mjs";import"../va-sidebar/index.mjs";import"../va-slider/index.mjs";import"../va-spacer/VaSpacer.mjs";import"../va-switch/index.mjs";import"../va-toast/index.mjs";import"../va-tabs/index.mjs";import"../va-time-input/index.mjs";import"../va-time-picker/index.mjs";import"../va-timeline/index.mjs";import"../va-tree-view/index.mjs";import{V as C}from"./VaFileUploadList/index.mjs";import{_ as S}from"../../../plugin-vue_export-helper.mjs";const T=e({name:"VaFileUpload",components:{VaModal:_,VaButton:F,VaFileUploadList:C},props:{fileTypes:{type:String,default:""},dropzone:{type:Boolean,default:!1},hideFileList:{type:Boolean,default:!1},color:{type:String,default:"primary"},disabled:{type:Boolean,default:!1},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3},undoButtonText:{type:String,default:"Undo"},dropZoneText:{type:String,default:"Drag’n’drop files or"},uploadButtonText:{type:String,default:"Upload file"},deletedFileMessage:{type:String,default:"File was successfully deleted"},modelValue:{type:[Object,Array],default:()=>[]},type:{type:String,default:"list",validator:e=>["list","gallery","single"].includes(e)}},emits:["update:modelValue","file-removed","file-added"],setup(e,{emit:r}){const n=i(),s=o(!1),m=o(!1),{getColor:p,shiftHSLAColor:u}=h(),v=a((()=>p(e.color))),c=a((()=>({backgroundColor:e.dropzone?u(v.value,{a:m.value?-.82:-.92}):"transparent"}))),f=b("va-file-upload",(()=>({dropzone:e.dropzone,disabled:e.disabled}))),x=a({get:()=>Array.isArray(e.modelValue)?e.modelValue:[e.modelValue],set(i){"single"===e.type?r("update:modelValue",i[0]):r("update:modelValue",i)}}),validateFiles=i=>i.filter((i=>{const o=i.name||i.url;if(!o)return!1;if(i.url)return!0;if(["audio/*","video/*","image/*"].find((i=>e.fileTypes.includes(i))))return!0;const a=o.substring(o.lastIndexOf(".")+1).toLowerCase(),t=e.fileTypes.includes(a);return t||(s.value=!0),t})),uploadFile=i=>{var o,a;const t=(null==(o=i.target)?void 0:o.files)||(null==(a=i.dataTransfer)?void 0:a.files);if(!t)return;const l=e.fileTypes?validateFiles(Array.from(t)):t;x.value="single"===e.type?l:[...x.value,...l],r("file-added",l)};return t((()=>{Array.isArray(x.value)&&(x.value=validateFiles(x.value))})),l(V,{undo:d(e,"undo"),disabled:d(e,"disabled"),undoDuration:d(e,"undoDuration"),undoButtonText:d(e,"undoButtonText"),deletedFileMessage:d(e,"deletedFileMessage")}),{modal:s,dropzoneHighlight:m,fileInputRef:n,colorComputed:v,computedStyle:c,computedClasses:f,files:x,uploadFile:uploadFile,changeFieldValue:e=>{uploadFile(e),n.value&&(n.value.value="")},removeFile:e=>{if(e in x.value){const i=x.value[e];x.value=x.value.filter(((i,o)=>o!==e)),r("file-removed",i)}},removeSingleFile:()=>{if(x.value.length>0){const e=x.value[0];x.value=[],r("file-removed",e)}},callFileDialogue:()=>{n.value&&n.value.click()}}}}),B={class:"va-file-upload__field"},k={key:0,class:"va-file-upload__field__text"},z=["accept","multiple","disabled"];var D=S(T,[["render",function _sfc_render(e,i,o,a,t,l){const d=r("va-button"),b=r("va-file-upload-list"),h=r("va-modal");return n(),s("div",{class:m(["va-file-upload",e.computedClasses]),style:p(e.computedStyle)},[u(e.$slots,"default",{},(()=>[v("div",B,[e.dropzone?(n(),s("div",k,c(e.dropZoneText),1)):f("",!0),x(d,{class:"va-file-upload__field__button",disabled:e.disabled,"aria-disabled":e.disabled,color:e.colorComputed,style:p({"pointer-events":e.dropzoneHighlight?"none":""}),onChange:e.changeFieldValue,onClick:e.callFileDialogue},{default:j((()=>[g(c(e.uploadButtonText),1)])),_:1},8,["disabled","aria-disabled","color","style","onChange","onClick"])])])),v("input",{ref:"fileInputRef",type:"file",class:"va-file-upload__field__input",tabindex:-1,"aria-hidden":"true",accept:e.fileTypes,multiple:"single"!==e.type,disabled:e.disabled,onChange:i[0]||(i[0]=(...i)=>e.changeFieldValue&&e.changeFieldValue(...i)),onDragenter:i[1]||(i[1]=i=>e.dropzoneHighlight=!0),onDragleave:i[2]||(i[2]=i=>e.dropzoneHighlight=!1)},null,40,z),e.files.length&&!e.$props.hideFileList?(n(),y(b,{key:0,type:e.type,files:e.files,color:e.colorComputed,onRemove:e.removeFile,onRemoveSingle:e.removeSingleFile},null,8,["type","files","color","onRemove","onRemoveSingle"])):f("",!0),x(h,{modelValue:e.modal,"onUpdate:modelValue":i[3]||(i[3]=i=>e.modal=i),"hide-default-actions":"",title:"File validation",message:"File type is incorrect!"},null,8,["modelValue"])],6)}]]);export{D as _};

import './VaFileUpload.css';
//# sourceMappingURL=VaFileUpload.mjs.map
