{"version":3,"file":"VaFileUploadGalleryItem.mjs","sources":["../../../../../../src/components/va-file-upload/VaFileUploadGalleryItem/VaFileUploadGalleryItem.vue"],"sourcesContent":["<template>\n  <va-list-item\n    class=\"va-file-upload-gallery-item\"\n    tabindex=\"-1\"\n    :class=\"classesComputed\"\n    :disabled=\"disabled\"\n    :aria-disabled=\"disabled\"\n    @focus=\"onFocus\"\n    @blur=\"onBlur\"\n  >\n    <va-list-item-section v-if=\"removed && undo\">\n      <va-file-upload-undo vertical @recover=\"recoverImage\" />\n    </va-list-item-section>\n    <va-list-item-section v-else>\n      <img\n        v-if=\"previewImage\"\n        :src=\"previewImage\"\n        :alt=\"file.name || ''\"\n        class=\"va-file-upload-gallery-item__image\"\n      >\n      <div class=\"va-file-upload-gallery-item__overlay\">\n        <div\n          class=\"va-file-upload-gallery-item__overlay-background\"\n          :style=\"overlayStylesComputed\"\n        />\n        <div\n          v-if=\"file && file.name\"\n          class=\"va-file-upload-gallery-item__name\"\n          :title=\"file.name\"\n        >\n          {{ file.name }}\n        </div>\n        <va-button\n          v-if=\"!disabled\"\n          flat\n          color=\"danger\"\n          icon=\"delete_outline\"\n          class=\"va-file-upload-gallery-item__delete\"\n          aria-label=\"remove file\"\n          @click=\"removeImage\"\n          @focus=\"onFocus\"\n          @blur=\"onBlur\"\n        />\n      </div>\n    </va-list-item-section>\n  </va-list-item>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, onMounted, ref, watch, computed, PropType } from 'vue'\n\nimport { colorToRgba } from '../../../services/color-config/color-functions'\nimport { useFocus, useBem, useStrictInject } from '../../../composables'\n\nimport { VaFileUploadKey, ConvertedFile } from '../types'\n\nimport { VaButton, VaListItem, VaListItemSection } from '../../index'\nimport { VaFileUploadUndo } from '../VaFileUploadUndo'\n\nconst INJECTION_ERROR_MESSAGE = 'The VaFileUploadGalleryItem component should be used in the context of VaFileUpload component'\n\nexport default defineComponent({\n  name: 'VaFileUploadGalleryItem',\n\n  components: {\n    VaFileUploadUndo,\n    VaButton,\n    VaListItem,\n    VaListItemSection,\n  },\n\n  emits: ['remove'],\n\n  props: {\n    file: { type: Object as PropType<ConvertedFile>, default: null },\n    color: { type: String, default: 'success' },\n  },\n\n  setup (props, { emit }) {\n    const {\n      undo,\n      disabled,\n      undoDuration,\n    } = useStrictInject(VaFileUploadKey, INJECTION_ERROR_MESSAGE)\n    const { isFocused, onFocus, onBlur } = useFocus()\n    const previewImage = ref('')\n    const removed = ref(false)\n\n    const overlayStylesComputed = computed(() => ({\n      backgroundColor: colorToRgba(props.color, 0.7),\n    }))\n\n    const classesComputed = useBem('va-file-upload-gallery-item', () => ({\n      notImage: !previewImage.value,\n      focused: isFocused.value,\n      undo: removed.value,\n    }))\n\n    const removeImage = () => {\n      if (undo.value) {\n        removed.value = true\n\n        setTimeout(() => {\n          if (!removed.value) { return }\n\n          emit('remove')\n          removed.value = false\n        }, undoDuration.value ?? 0)\n      } else {\n        emit('remove')\n        removed.value = false\n      }\n    }\n\n    const recoverImage = () => { removed.value = false }\n\n    const convertToImg = () => {\n      if (!props.file.name || !props.file.image) { return }\n\n      if (props.file.image.url) {\n        previewImage.value = props.file.image.url\n      } else if (props.file.image instanceof File) {\n        const reader = new FileReader()\n\n        reader.readAsDataURL(props.file.image)\n        reader.onload = (e) => {\n          if ((e.target?.result as string).includes('image')) {\n            previewImage.value = e.target?.result as string\n          }\n        }\n      }\n    }\n\n    onMounted(convertToImg)\n    watch(() => props.file, convertToImg)\n\n    return {\n      undo,\n      removed,\n      disabled,\n      isFocused,\n      previewImage,\n      classesComputed,\n      overlayStylesComputed,\n\n      onBlur,\n      onFocus,\n      removeImage,\n      recoverImage,\n    }\n  },\n})\n</script>\n\n<style lang='scss'>\n@import \"variables\";\n@import \"../../../styles/resources\";\n\n$max-image-size: 8.5714rem;\n\n.va-file-upload-gallery-item {\n  display: flex;\n  position: relative;\n  margin-bottom: 1rem;\n  margin-right: 0.5rem;\n  flex-basis: calc(14.2857% - 0.5rem);\n  max-width: calc(14.2857% - 0.5rem);\n  min-width: $max-image-size;\n  border-radius: 0.375rem;\n  overflow: hidden;\n  width: 100%;\n  align-items: stretch;\n\n  @include media-breakpoint-down(md) {\n    flex-basis: calc(16.667% - 0.5rem);\n    max-width: calc(16.667% - 0.5rem);\n  }\n\n  @include media-breakpoint-down(sm) {\n    flex-basis: calc(20% - 0.5rem);\n    max-width: calc(20% - 0.5rem);\n  }\n\n  @include media-breakpoint-down(xs) {\n    flex-basis: calc(50% - 0.5rem);\n    max-width: calc(50% - 0.5rem);\n  }\n\n  &:last-of-type {\n    margin-right: 0;\n  }\n\n  &:hover,\n  &:focus,\n  &--focused {\n    .va-file-upload-gallery-item__overlay {\n      z-index: 3;\n      opacity: 1;\n    }\n\n    .va-file-upload-gallery-item {\n      &__name {\n        color: var(--va-file-upload-gallery-item-text-hover);\n      }\n    }\n  }\n\n  &__overlay {\n    display: flex;\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n    flex-direction: column;\n    padding: 0.5rem;\n    z-index: -1;\n    opacity: 0;\n  }\n\n  &__overlay-background {\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n    z-index: -1;\n  }\n\n  &__image {\n    width: 100%;\n    box-shadow: var(--va-box-shadow);\n    object-fit: cover;\n    z-index: 1;\n  }\n\n  &__name {\n    color: var(--va-file-upload-gallery-item-text);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    font-size: 0.875rem;\n  }\n\n  &__delete {\n    cursor: pointer;\n    font-size: 1.5rem;\n    margin-top: auto;\n  }\n\n  &--not-image {\n    .va-file-upload-gallery-item__overlay {\n      display: flex;\n    }\n  }\n\n  &--undo {\n    .va-list-item__inner {\n      display: flex;\n      align-items: flex-start;\n      position: relative;\n    }\n\n    .va-list-item-section {\n      height: inherit;\n      padding: 0;\n    }\n\n    .va-file-upload-undo {\n      flex: 1;\n    }\n  }\n}\n</style>\n"],"names":["_sfc_main","defineComponent","name","components","VaFileUploadUndo","VaButton","VaListItem","VaListItemSection","emits","props","file","type","Object","default","color","String","setup","emit","undo","disabled","undoDuration","useStrictInject","VaFileUploadKey","isFocused","onFocus","onBlur","useFocus","previewImage","ref","removed","overlayStylesComputed","computed","backgroundColor","colorToRgba","classesComputed","useBem","notImage","value","focused","convertToImg","image","url","File","reader","FileReader","readAsDataURL","onload","e","target","_a","result","includes","_b","onMounted","watch","removeImage","setTimeout","recoverImage","_hoisted_2","class","_createBlock","_component_va_list_item","_normalizeClass","_ctx","tabindex","_component_va_list_item_section","key","_withCtx","_createVNode","_component_va_file_upload_undo","vertical","onRecover","_createElementBlock","src","alt","_hoisted_1","_createCommentVNode","_createElementVNode","style","_normalizeStyle","title","_toDisplayString","_hoisted_3","openBlock","_component_va_button","flat","icon","onClick"],"mappings":"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"}