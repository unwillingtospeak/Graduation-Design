{"version":3,"file":"range-model-value-guard.mjs","sources":["../../../../../../src/components/va-date-input/hooks/range-model-value-guard.ts"],"sourcesContent":["import { computed, Ref, ref, watch } from 'vue'\n\nimport { parseModelValue, isRange } from './model-value-parser'\nimport { DateInputModelValue } from '../types'\n\n/**\n * This guard is used to prevent updating modelValue if range end is not specified.\n * This guard provides reset method, that allow us to reset VaDateInput value if dropdown is closed.\n */\nexport const useRangeModelValueGuard = (\n  modelValue: Ref<DateInputModelValue>,\n  disabled: Ref<boolean>,\n  parseValue = parseModelValue,\n) => {\n  const bufferValue = ref<DateInputModelValue>(modelValue.value && parseValue(modelValue.value))\n\n  const valueComputed = computed({\n    get: () => bufferValue.value,\n    set: (value) => {\n      if (disabled.value) {\n        modelValue.value = value\n      }\n\n      if (!value) {\n        modelValue.value = value\n        return\n      }\n\n      if (isRange(value)) {\n        if (value.end !== null) {\n          modelValue.value = value\n        }\n      } else {\n        modelValue.value = value\n      }\n\n      bufferValue.value = value\n    },\n  })\n\n  watch(modelValue, (newValue) => {\n    bufferValue.value = newValue\n  })\n\n  const reset = () => {\n    if (bufferValue.value && isRange(bufferValue.value)) {\n      bufferValue.value = modelValue.value && parseValue(modelValue.value)\n    }\n  }\n\n  return {\n    valueComputed,\n    reset,\n  }\n}\n"],"names":["useRangeModelValueGuard","modelValue","disabled","parseValue","parseModelValue","bufferValue","ref","value","valueComputed","computed","get","set","isRange","end","watch","newValue","reset"],"mappings":"uGASO,MAAMA,wBAA0B,CACrCC,EACAC,EACAC,EAAaC,KAEb,MAAMC,EAAcC,EAAyBL,EAAWM,OAASJ,EAAWF,EAAWM,QAEjFC,EAAgBC,EAAS,CAC7BC,IAAK,IAAML,EAAYE,MACvBI,IAAMJ,IACAL,EAASK,QACXN,EAAWM,MAAQA,GAGhBA,GAKDK,EAAQL,GACQ,OAAdA,EAAMM,MACRZ,EAAWM,MAAQA,GAGrBN,EAAWM,MAAQA,EAGrBF,EAAYE,MAAQA,GAZlBN,EAAWM,MAAQA,KAgBnBO,EAAAb,GAAac,IACjBV,EAAYE,MAAQQ,KASf,MAAA,CACLP,cAAAA,EACAQ,MARY,KACRX,EAAYE,OAASK,EAAQP,EAAYE,SAC3CF,EAAYE,MAAQN,EAAWM,OAASJ,EAAWF,EAAWM"}