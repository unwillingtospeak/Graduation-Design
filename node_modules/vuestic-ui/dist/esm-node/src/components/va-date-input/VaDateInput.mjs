var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,__defNormalProp=(a,t,o)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,__spreadValues=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&__defNormalProp(e,t,a[t]);if(o)for(var t of o(a))n.call(a,t)&&__defNormalProp(e,t,a[t]);return e},__spreadProps=(e,o)=>a(e,t(o));import{defineComponent as s,shallowRef as l,ref as i,toRefs as u,computed as p,watch as d,nextTick as c,resolveComponent as m,openBlock as v,createBlock as f,normalizeClass as y,normalizeStyle as b,withCtx as V,renderSlot as k,normalizeProps as h,guardReactiveProps as P,createVNode as C,mergeProps as D,createSlots as j,createElementVNode as x,toHandlers as I,createCommentVNode as g,withModifiers as w,withKeys as _,renderList as O}from"vue";import{o as $}from"../../../vendor.mjs";import{e as S,a as F,f as T}from"../../utils/child-props.mjs";import{u as B,a as W,b as A}from"../../composables/useClearable.mjs";import"colortranslator";import{u as L,a as E}from"../../composables/useFocus.mjs";import{u as H}from"../../composables/useParsable.mjs";import"../../composables/useDropdown.mjs";import{u as K,b as M}from"../../composables/useStateful.mjs";import{u as U,a as q,b as R}from"../../composables/useValidation.mjs";import{u as z}from"../va-date-picker/hooks/sync-prop.mjs";import{u as N}from"./hooks/range-model-value-guard.mjs";import{u as G}from"./hooks/input-text-parser.mjs";import{i as J,a as Q,b as X}from"../va-date-picker/utils/date-utils.mjs";import{_ as Y}from"../va-date-picker/VaDatePicker.mjs";import{V as Z}from"../va-dropdown/index.mjs";import"../va-input/index.mjs";import{V as ee}from"../va-icon/index.mjs";import{_ as ae}from"../../../plugin-vue_export-helper.mjs";import{V as te}from"../va-dropdown/components/VaDropdownContent/index.mjs";import{V as oe}from"../va-input/components/VaInputWrapper/VaInputWrapper.mjs";const re=S(oe,["focused","maxLength","counterValue"]),ne=S(Y);var se=ae(s({name:"VaDateInput",components:{VaDropdown:Z,VaDropdownContent:te,VaDatePicker:Y,VaInputWrapper:oe,VaIcon:ee},props:__spreadProps(__spreadValues(__spreadValues(__spreadValues(__spreadValues({},B),re),ne),U),{clearValue:{type:Date,default:void 0},modelValue:{type:[Date,Array,Object,String,Number]},resetOnClose:{type:Boolean,default:!0},isOpen:{type:Boolean,default:void 0},format:{type:Function},formatDate:{type:Function,default:e=>e.toLocaleDateString()},parse:{type:Function},parseDate:{type:Function},parseValue:{type:Function},delimiter:{type:String,default:", "},rangeDelimiter:{type:String,default:" ~ "},manualInput:{type:Boolean,default:!1},color:{type:String,default:"primary"},leftIcon:{type:Boolean,default:!1},icon:{type:String,default:"calendar_today"}}),emits:[...L,...F(Y),...W,...q,...K,"update:is-open","update:text"],inheritAttrs:!1,setup(e,{emit:a,slots:t,attrs:o}){const r=l(),n=i(),{isOpen:s,resetOnClose:m}=u(e),{valueComputed:v}=M(e,a),{syncProp:f}=z(s,"is-open",a,!1),{isFocused:y,focus:b,blur:V,onFocus:k,onBlur:h}=E(r),P=p((()=>!m.value)),{valueComputed:C,reset:D}=N(v,P,e.parseValue);d(f,(e=>{e||P.value||D()}));const dateOrNothing=a=>a?e.formatDate(a):"...",{parseDateInputValue:j,isValid:x}=G(e);d(C,(()=>{x.value=!0}));const modelValueToString=a=>{if(e.format)return e.format(C.value);if(J(a))return a.map((a=>e.formatDate(a))).join(e.delimiter);if(Q(a))return e.formatDate(a);if(X(a))return dateOrNothing(a.start)+e.rangeDelimiter+dateOrNothing(a.end);throw new Error("VaDatePicker: Invalid model value. Value should be Date, Date[] or { start: Date, end: Date | null }")},{text:I,value:g}=H(C,j,modelValueToString),w=p((()=>x.value?C.value?I.value:e.clearValue?modelValueToString(e.clearValue):"":"")),reset=()=>{v.value=e.clearValue,a("clear")},focusDatePicker=()=>{c((()=>{var e;return null==(e=n.value)?void 0:e.focusCurrentPicker()}))},focusInputOrPicker=()=>{f.value?focusDatePicker():b()},{computedError:_,computedErrorMessages:O,listeners:S,validationAriaAttributes:F}=R(e,a,reset,b),B=p((()=>!x.value&&C.value!==e.clearValue||_.value)),W=p((()=>{const a=[e.leftIcon&&"prependInner",(!e.leftIcon||e.clearable)&&"icon"];return Object.keys(t).filter((e=>!a.includes(e)))})),{canBeCleared:L,clearIconProps:K,onFocus:U,onBlur:q}=A(e,C),Y=p((()=>({name:e.icon,color:e.color,size:"small",class:"va-date-input__icon"}))),Z=p((()=>e.disabled||e.readonly?-1:0)),ee=p((()=>__spreadProps(__spreadValues({},T(e,re).value),{focused:y.value,error:B.value,errorMessages:O.value,readonly:e.readonly||!e.manualInput}))),ae=p((()=>({focus:()=>{e.disabled||(k(),e.readonly||(U(),S.onFocus()))},blur:()=>{e.disabled||(h(),e.readonly||(q(),S.onBlur()))}}))),te=p((()=>__spreadValues(__spreadValues({readonly:e.readonly||!e.manualInput,tabindex:e.disabled?-1:0,value:w.value,ariaLabel:e.label||"selected date",ariaRequired:e.requiredMark,ariaDisabled:e.disabled,ariaReadOnly:e.readonly},F.value),$(o,["class","style"]))));return{datePicker:n,valueText:w,valueWithoutText:g,valueComputed:C,isOpenSync:f,onInputTextChanged:({target:e})=>{const a=j(e.value);x.value&&(C.value=a)},isFocused:y,input:r,inputWrapperProps:ee,inputListeners:ae,inputAttributesComputed:te,datePickerProps:T(e,ne),filterSlots:W,canBeCleared:L,clearIconProps:K,iconProps:Y,hideAndFocus:()=>{f.value=!1,b()},toggleDropdown:a=>{var t;(t=a instanceof KeyboardEvent?a:void 0,f.value||!(e.disabled||e.readonly||e.manualInput&&"Space"!==(null==t?void 0:t.code)))&&(f.value=!f.value,c(focusInputOrPicker))},showDropdown:()=>{e.disabled||e.readonly||(f.value=!0,c(focusDatePicker))},focusInputOrPicker:focusInputOrPicker,focusDatePicker:focusDatePicker,reset:reset,focus:b,blur:V,iconTabindexComputed:Z}}}),[["render",function _sfc_render(e,a,t,o,r,n){const s=m("va-icon"),l=m("va-input-wrapper"),i=m("va-date-picker"),u=m("va-dropdown-content"),p=m("va-dropdown");return v(),f(p,{modelValue:e.isOpenSync,"onUpdate:modelValue":a[9]||(a[9]=a=>e.isOpenSync=a),class:y(["va-date-input",e.$attrs.class]),"inner-anchor-selector":".va-input-wrapper__field",style:b(e.$attrs.style),offset:[2,0],"close-on-content-click":!1,stateful:!1,disabled:e.$props.disabled,"keyboard-navigation":"",onOpen:e.focusDatePicker,onClose:e.focus},{anchor:V((()=>[k(e.$slots,"input",h(P({valueText:e.valueText,inputAttributes:e.inputAttributesComputed,inputWrapperProps:e.inputWrapperProps,inputListeners:e.inputListeners})),(()=>[C(l,D(e.inputWrapperProps,{class:"va-date-input__anchor"}),j({default:V((()=>[x("input",D({ref:"input",class:"va-date-input__input"},e.inputAttributesComputed,I(e.inputListeners),{onChange:a[0]||(a[0]=(...a)=>e.onInputTextChanged&&e.onInputTextChanged(...a))}),null,16)])),prependInner:V((a=>[k(e.$slots,"prependInner",h(P(a))),e.$props.leftIcon?(v(),f(s,h(D({key:0},e.iconProps)),null,16)):g("",!0)])),icon:V((()=>[e.canBeCleared?(v(),f(s,D({key:0,class:"va-date-input__clear-icon",role:"button","aria-label":"reset date","aria-hiden":"false",tabindex:e.iconTabindexComputed},e.clearIconProps,{onClick:w(e.reset,["stop"]),onKeydown:[_(w(e.reset,["stop"]),["enter"]),_(w(e.reset,["stop"]),["space"])]}),null,16,["tabindex","onClick","onKeydown"])):e.$props.leftIcon?g("",!0):(v(),f(s,D({key:1,tabindex:e.iconTabindexComputed},e.iconProps),null,16,["tabindex"]))])),_:2},[O(e.filterSlots,(a=>({name:a,fn:V((t=>[k(e.$slots,a,h(P(t)))]))})))]),1040)]))])),default:V((()=>[C(u,{class:"va-date-input__dropdown-content"},{default:V((()=>[C(i,D({ref:"datePicker"},e.datePickerProps,{modelValue:e.valueWithoutText,"onUpdate:modelValue":a[1]||(a[1]=a=>e.valueWithoutText=a),"onClick:day":a[2]||(a[2]=a=>e.$emit("click:day",a)),"onClick:month":a[3]||(a[3]=a=>e.$emit("click:month",a)),"onClick:year":a[4]||(a[4]=a=>e.$emit("click:year",a)),"onHover:day":a[5]||(a[5]=a=>e.$emit("hover:day",a)),"onHover:month":a[6]||(a[6]=a=>e.$emit("hover:month",a)),"onHover:year":a[7]||(a[7]=a=>e.$emit("hover:year",a)),"onUpdate:view":a[8]||(a[8]=a=>e.$emit("update:view",a))}),j({_:2},[O(e.$slots,((a,t)=>({name:t,fn:V((a=>[k(e.$slots,t,h(P(a)))]))})))]),1040,["modelValue"])])),_:3})])),_:3},8,["modelValue","class","style","disabled","onOpen","onClose"])}]]);export{se as _};

import './VaDateInput.css';
//# sourceMappingURL=VaDateInput.mjs.map
