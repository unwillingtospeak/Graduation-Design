{"version":3,"file":"VaTreeCategory.mjs","sources":["../../../../../../src/components/va-tree-view/VaTreeCategory/VaTreeCategory.vue"],"sourcesContent":["<template>\n  <div class=\"va-tree-category\">\n    <div\n      class=\"va-tree-category__header\"\n      @click=\"toggle\"\n    >\n      <div class=\"va-tree-category__header-switcher\">\n        <square-with-icon\n          :icon=\"isOpenCached ? 'remove' : 'add'\"\n          :color=\"colorComputed\"\n        />\n      </div>\n      <div\n        class=\"va-tree-category__header-checkbox\"\n        v-if=\"$slots.checkbox\"\n      >\n        <slot name=\"checkbox\" />\n      </div>\n      <div\n        class=\"va-tree-category__header-icon\"\n        v-if=\"$props.icon\"\n      >\n        <va-icon\n          :name=\"$props.icon\"\n          :color=\"getColor('info')\"\n        />\n      </div>\n      <div class=\"va-tree-category__header-label\">\n        {{ $props.label }}\n      </div>\n    </div>\n\n    <div\n      class=\"va-tree-category__list-container\"\n      v-if=\"isOpenCached\"\n    >\n      <div class=\"va-tree-category__list-internal-container\">\n        <slot />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {\n  ComponentPublicInstance,\n  defineComponent,\n  inject,\n  nextTick,\n  onBeforeUnmount,\n  onMounted,\n  provide,\n  ref,\n  Ref,\n  watch,\n  computed,\n} from 'vue'\nimport SquareWithIcon from '../SquareWithIcon/SquareWithIcon.vue'\nimport VaIcon from '../../va-icon/VaIcon.vue'\nimport { useColors } from '../../../composables'\nimport { TreeCategory, TreeNodeCommon, TreeCategoryKey, TreeNodeComponent, TreeViewKey } from '../types'\nimport VaTreeNode from '../VaTreeNode/VaTreeNode.vue'\n\nexport default defineComponent({\n  name: 'VaTreeCategory',\n  components: {\n    SquareWithIcon,\n    VaIcon,\n  },\n  props: {\n    label: {\n      type: [String, Number],\n      default: '',\n    },\n    isOpen: {\n      type: Boolean,\n      default: false,\n    },\n    icon: {\n      type: String,\n      default: '',\n    },\n    color: {\n      type: String,\n      default: 'primary',\n    },\n  },\n  setup: (props) => {\n    const { getColor } = useColors()\n    const colorComputed = computed(() => getColor(props.color))\n\n    const nodes: Ref<TreeNodeComponent[]> = ref([])\n    const isOpenCached = ref<boolean | undefined>(false)\n\n    const onChildMounted = (node: TreeNodeComponent) => {\n      nodes.value.push(node)\n    }\n\n    const onChildUnmounted = (removableNode: TreeNodeComponent) => {\n      nodes.value = nodes.value.filter((node: TreeNodeComponent) => node !== removableNode)\n    }\n\n    const treeView: TreeNodeCommon<TreeCategory | typeof VaTreeNode> = inject(TreeViewKey, {\n      onChildMounted: (value: TreeCategory | typeof VaTreeNode) => undefined,\n      onChildUnmounted: (value: TreeCategory | typeof VaTreeNode) => undefined,\n    })\n\n    const collapse = () => {\n      isOpenCached.value = false\n\n      nextTick(() => {\n        nodes.value.forEach((child: ComponentPublicInstance) => {\n          if (child.$options.name === 'va-tree-category') {\n            (child as ComponentPublicInstance<TreeCategory>).collapse()\n          }\n        })\n      })\n    }\n\n    const expand = () => {\n      isOpenCached.value = true\n\n      nextTick(() => {\n        nodes.value.forEach((child: TreeNodeComponent) => {\n          child.expand?.()\n        })\n      })\n    }\n\n    const toggle = (e: MouseEvent) => {\n      if (!(e.target as HTMLElement).classList.contains('va-checkbox__input')) {\n        isOpenCached.value = !isOpenCached.value\n      }\n    }\n\n    watch(\n      () => props.isOpen,\n      (isOpen) => {\n        isOpenCached.value = isOpen\n      },\n      { immediate: true })\n\n    const treeCategory: TreeCategory = {\n      treeView,\n      nodes: nodes.value,\n      isOpenCached: isOpenCached.value,\n      onChildMounted,\n      onChildUnmounted,\n      collapse,\n      expand,\n      toggle,\n    }\n\n    provide(TreeCategoryKey, treeCategory)\n    onMounted(() => treeView?.onChildMounted(treeCategory))\n    onBeforeUnmount(() => treeView?.onChildUnmounted(treeCategory))\n\n    return {\n      treeCategory,\n      treeView,\n      nodes,\n      isOpenCached,\n      collapse,\n      expand,\n      toggle,\n      getColor,\n      colorComputed,\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n@import \"../../../styles/resources\";\n@import 'variables';\n\n.va-tree-category {\n  font-family: var(--va-font-family);\n\n  &__header {\n    cursor: var(--va-tree-category-header-cursor);\n    display: var(--va-tree-category-header-display);\n    align-items: var(--va-tree-category-header-align-items);\n  }\n\n  &__header-switcher {\n    margin-right: 0.5rem;\n  }\n\n  &__header-checkbox {\n    margin-right: var(--va-tree-category-header-checkbox-margin-right);\n    height: var(--va-tree-category-header-checkbox-height);\n    width: var(--va-tree-category-header-checkbox-width);\n    display: var(--va-tree-category-header-checkbox-display);\n    align-items: var(--va-tree-category-header-checkbox-align-items);\n    justify-content: var(--va-tree-category-header-checkbox-justify-content);\n\n    .va-checkbox__square {\n      width: 1.5rem;\n      height: 1.5rem;\n      flex: 0 0 1.5rem;\n    }\n  }\n\n  &__header-icon {\n    color: var(--va-tree-category-header-icon-color);\n    margin-right: var(--va-tree-category-header-icon-margin-right);\n    font-size: var(--va-tree-category-header-icon-font-size);\n    line-height: var(--va-tree-category-header-icon-line-height);\n  }\n\n  &__header-label {\n    word-wrap: var(--va-tree-category-header-label-word-wrap);\n    overflow: var(--va-tree-category-header-label-overflow);\n    line-height: var(--va-tree-category-header-label-line-height);\n  }\n\n  &__list-container {\n    margin-top: var(--va-tree-category-list-container-margin-top);\n    padding-left: var(--va-tree-category-list-container-padding-left);\n  }\n\n  &__list-internal-container {\n    background-image: linear-gradient(#adb3b9 33%, rgba(255, 255, 255, 0) 0%);\n    background-position: left;\n    background-size: 1px 3px;\n    background-repeat: repeat-y;\n    padding-left: 1.1875rem;\n  }\n\n  & + .va-tree-category,\n  .va-tree-node + .va-tree-node,\n  .va-tree-category + .va-tree-node,\n  .va-tree-node + .va-tree-category {\n    margin-top: 0.75rem;\n  }\n}\n</style>\n"],"names":["_sfc_main","defineComponent","name","components","SquareWithIcon","VaIcon","props","label","type","String","Number","default","isOpen","Boolean","icon","color","setup","getColor","useColors","colorComputed","computed","nodes","ref","isOpenCached","treeView","inject","TreeViewKey","onChildMounted","value","onChildUnmounted","collapse","nextTick","forEach","child","$options","expand","_a","call","toggle","e","target","classList","contains","watch","immediate","treeCategory","node","push","removableNode","filter","provide","TreeCategoryKey","onMounted","onBeforeUnmount","_hoisted_1","class","_hoisted_2","_hoisted_5","_hoisted_7","_openBlock","_createElementBlock","_createElementVNode","onClick","_cache","args","_ctx","_createVNode","_component_square_with_icon","$slots","checkbox","_hoisted_3","_renderSlot","_createCommentVNode","$props","_hoisted_4","_component_va_icon","_toDisplayString","_hoisted_6"],"mappings":"0oBA+DA,MAAKA,EAAaC,EAAa,CAC7BC,KAAM,iBACNC,WAAY,CACVC,eAAAA,EACAC,OAAAA,GAEFC,MAAO,CACLC,MAAO,CACLC,KAAM,CAACC,OAAQC,QACfC,QAAS,IAEXC,OAAQ,CACNJ,KAAMK,QACNF,SAAS,GAEXG,KAAM,CACJN,KAAMC,OACNE,QAAS,IAEXI,MAAO,CACLP,KAAMC,OACNE,QAAS,YAGbK,MAAQV,IACA,MAAAW,SAAEA,GAAaC,IACfC,EAAgBC,GAAS,IAAMH,EAASX,EAAMS,SAE9CM,EAAkCC,EAAI,IACtCC,EAAeD,GAAyB,GAUxCE,EAA6DC,EAAOC,EAAa,CACrFC,eAAiBC,MACjBC,iBAAmBD,QAGfE,SAAW,KACfP,EAAaK,OAAQ,EAErBG,GAAS,KACDV,EAAAO,MAAMI,SAASC,IACS,qBAAxBA,EAAMC,SAAShC,MAChB+B,EAAgDH,kBAMnDK,OAAS,KACbZ,EAAaK,OAAQ,EAErBG,GAAS,KACDV,EAAAO,MAAMI,SAASC,UACnB,OAAAG,EAAAH,EAAME,SAANC,EAAAC,KAAAJ,UAKAK,OAAUC,IACRA,EAAEC,OAAuBC,UAAUC,SAAS,wBACnCnB,EAAAK,OAASL,EAAaK,QAIvCe,GACE,IAAMrC,EAAMM,SACXA,IACCW,EAAaK,MAAQhB,IAEvB,CAAEgC,WAAW,IAEf,MAAMC,EAA6B,CACjCrB,SAAAA,EACAH,MAAOA,EAAMO,MACbL,aAAcA,EAAaK,MAC3BD,eApDsBmB,IAChBzB,EAAAO,MAAMmB,KAAKD,IAoDjBjB,iBAjDwBmB,IACxB3B,EAAMO,MAAQP,EAAMO,MAAMqB,QAAQH,GAA4BA,IAASE,KAiDvElB,SAAAA,SACAK,OAAAA,OACAG,OAAAA,QAOK,OAJPY,EAAQC,EAAiBN,GACfO,GAAA,IAAgB,MAAV5B,OAAU,EAAAA,EAAAG,eAAekB,KACzBQ,GAAA,IAAgB,MAAV7B,OAAU,EAAAA,EAAAK,iBAAiBgB,KAE1C,CACLA,aAAAA,EACArB,SAAAA,EACAH,MAAAA,EACAE,aAAAA,EACAO,SAAAA,SACAK,OAAAA,OACAG,OAAAA,OACArB,SAAAA,EACAE,cAAAA,MArKCmC,EAAA,CAAAC,MAAM,oBAKFC,EAAA,CAAAD,MAAM,8CAOTA,MAAM,8CAMNA,MAAM,iCAQHE,EAAA,CAAAF,MAAM,2CAMXA,MAAM,oCAGDG,EAAA,CAAAH,MAAM,iJAnCf,OAAAI,IAAAC,EAuCM,MAvCNN,EAuCM,CAtCJO,EA4BM,MAAA,CA3BJN,MAAM,2BACLO,QAAKC,EAAE,KAAAA,EAAA,GAAA,IAAAC,IAAAC,EAAA3B,QAAA2B,EAAA3B,UAAA0B,KAAA,CAERH,EAKM,MALNL,EAKM,CAJJU,EAGEC,EAAA,CAFCrD,KAAMmD,EAAY1C,aAAA,SAAA,MAClBR,MAAOkD,EAAA9C,eAAA,KAAA,EAAA,CAAA,OAAA,YAKJ8C,EAAOG,OAAAC,cAFfT,EAKM,MALNU,EAKM,CADJC,EAAwBN,EAAAG,OAAA,eAAAI,EAAA,IAAA,GAIlBP,EAAOQ,OAAA3D,UAFf8C,EAQM,MARNc,EAQM,CAJJR,EAGES,EAAA,CAFCzE,KAAM+D,EAAOQ,OAAA3D,KACbC,MAAOkD,EAAQhD,SAAA,SAAA,KAAA,EAAA,CAAA,OAAA,sBAGpB4C,EAEM,MAFNJ,EAEMmB,EADDX,EAAAQ,OAAOlE,OAAK,KAMX0D,EAFR1C,cAAAoC,IAAAC,EAOM,MAPNiB,EAOM,CAHJhB,EAEM,MAFNH,EAEM,CADJa,EAAQN,EAAAG,OAAA"}