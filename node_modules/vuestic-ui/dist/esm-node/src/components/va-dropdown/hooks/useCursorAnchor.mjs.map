{"version":3,"file":"useCursorAnchor.mjs","sources":["../../../../../../src/components/va-dropdown/hooks/useCursorAnchor.ts"],"sourcesContent":["import { computed, reactive, Ref, watch, watchEffect } from 'vue'\nimport { useEvent } from '../../../composables/useEvent'\n\nexport const useCursorAnchor = (anchorRef: Ref<HTMLElement | undefined>, noUpdate: Ref<boolean>) => {\n  const mouse = reactive({ x: 0, y: 0 })\n\n  useEvent(['mousemove', 'mousedown', 'mouseup'], (e: MouseEvent) => {\n    const { x, y } = anchorRef.value!.getBoundingClientRect()\n    mouse.x = e.clientX - x\n    mouse.y = e.clientY - y\n  }, anchorRef)\n\n  const mouseOffset = {\n    x: 0,\n    y: 0,\n  }\n\n  watchEffect(() => {\n    if (noUpdate.value) { return }\n    mouseOffset.x = mouse.x\n    mouseOffset.y = mouse.y\n  })\n\n  return computed(() => {\n    if (!anchorRef.value) { return undefined }\n\n    const target = anchorRef.value\n\n    const getBoundingClientRect = () => {\n      const rect = target.getBoundingClientRect()\n      const x = rect.left + mouseOffset.x\n      const y = rect.top + mouseOffset.y\n\n      return {\n        ...rect,\n        x: x,\n        y: y,\n        bottom: y + 1,\n        right: x + 1,\n        left: x,\n        top: y,\n      }\n    }\n\n    return new Proxy<HTMLElement>(target, {\n      get (target, key: keyof typeof target) {\n        if (key === 'getBoundingClientRect') {\n          return getBoundingClientRect\n        }\n\n        return target[key]\n      },\n    })\n  })\n}\n"],"names":["useCursorAnchor","anchorRef","noUpdate","mouse","reactive","x","y","useEvent","e","value","getBoundingClientRect","clientX","clientY","mouseOffset","watchEffect","computed","target","rect","left","top","bottom","right","Proxy","get","target2","key"],"mappings":"wZAGa,MAAAA,gBAAkB,CAACC,EAAyCC,KACvE,MAAMC,EAAQC,EAAS,CAAEC,EAAG,EAAGC,EAAG,IAElCC,EAAS,CAAC,YAAa,YAAa,YAAaC,IAC/C,MAAMH,EAAEA,EAAAC,EAAGA,GAAML,EAAUQ,MAAOC,wBAC5BP,EAAAE,EAAIG,EAAEG,QAAUN,EAChBF,EAAAG,EAAIE,EAAEI,QAAUN,IACrBL,GAEH,MAAMY,EAAc,CAClBR,EAAG,EACHC,EAAG,GASL,OANAQ,GAAY,KACNZ,EAASO,QACbI,EAAYR,EAAIF,EAAME,EACtBQ,EAAYP,EAAIH,EAAMG,MAGjBS,GAAS,KACV,IAACd,EAAUQ,MAAgB,OAE/B,MAAMO,EAASf,EAAUQ,MAEnBC,sBAAwB,KACtB,MAAAO,EAAOD,EAAON,wBACdL,EAAIY,EAAKC,KAAOL,EAAYR,EAC5BC,EAAIW,EAAKE,IAAMN,EAAYP,EAE1B,4JACFW,SADE,CAELZ,EAAAA,EACAC,EAAAA,EACAc,OAAQd,EAAI,EACZe,MAAOhB,EAAI,EACXa,KAAMb,EACNc,IAAKb,YAIF,OAAA,IAAIgB,MAAmBN,EAAQ,CACpCO,IAAA,CAAKC,EAAQC,IACC,0BAARA,EACKf,sBAGFc,EAAOC"}