{"version":3,"file":"VaCollapse.mjs","sources":["../../../../../src/components/va-collapse/VaCollapse.vue"],"sourcesContent":["<template>\n  <div class=\"va-collapse\" :class=\"computedClasses\">\n    <div\n      class=\"va-collapse__header-wrapper\"\n      v-on=\"keyboardFocusListeners\"\n      @focus=\"$emit('focus')\"\n      @click=\"toggle\"\n      @keydown.enter=\"toggle\"\n      @keydown.space=\"toggle\"\n    >\n      <slot\n        name=\"header\"\n        v-bind=\"{\n          value: computedModelValue,\n          hasKeyboardFocus: hasKeyboardFocus,\n          bind: headerAttributes,\n          attributes: headerAttributes,\n        }\"\n      >\n        <div\n          v-bind=\"headerAttributes\"\n          class=\"va-collapse__header\"\n          :style=\"headerStyle\"\n        >\n          <va-icon\n            v-if=\"icon\"\n            class=\"va-collapse__header__icon\"\n            :name=\"icon\"\n            :color=\"textColorComputed\"\n          />\n          <div class=\"va-collapse__header__text\">\n            {{ header }}\n          </div>\n          <va-icon\n            class=\"va-collapse__header__icon\"\n            :name=\"computedModelValue ? 'expand_less' : 'expand_more'\"\n            :color=\"textColorComputed\"\n          />\n        </div>\n      </slot>\n    </div>\n    <div class=\"va-collapse__body-wrapper\" :style=\"contentStyle\">\n      <div\n        class=\"va-collapse_body\"\n        ref=\"body\"\n        role=\"region\"\n        :id=\"panelIdComputed\"\n        :aria-labelledby=\"headerIdComputed\"\n      >\n        <slot />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, ref, shallowRef } from 'vue'\nimport pick from 'lodash/pick.js'\n\nimport { useKeyboardOnlyFocus, useColors, useSyncProp, useTextColor, useBem, useResizeObserver } from '../../composables'\nimport { useAccordionItem } from '../va-accordion/hooks/useAccordion'\n\nimport { generateUniqueId } from '../../services/utils'\n\nimport { VaIcon } from '../va-icon'\n\nexport default defineComponent({\n  name: 'VaCollapse',\n  components: {\n    VaIcon,\n  },\n  props: {\n    modelValue: { type: Boolean, default: undefined },\n    disabled: { type: Boolean, default: false },\n    header: { type: String, default: '' },\n    icon: { type: String, default: '' },\n    solid: { type: Boolean, default: false },\n    color: { type: String, default: 'background' },\n    textColor: { type: String, default: '' },\n    colorAll: { type: Boolean, default: false },\n  },\n  emits: ['focus', 'update:modelValue'],\n\n  setup (props, { emit, slots }) {\n    const body = shallowRef<HTMLElement>()\n\n    const [computedModelValue] = useSyncProp('modelValue', props, emit, false)\n\n    const { getColor, getHoverColor } = useColors()\n    const { accordionProps, toggle } = useAccordionItem(computedModelValue)\n\n    const { textColorComputed } = useTextColor()\n\n    const bodyHeight = ref()\n    useResizeObserver([body], () => {\n      bodyHeight.value = body.value?.clientHeight ?? 0\n    })\n\n    const height = computed(() => computedModelValue.value ? bodyHeight.value : 0)\n\n    const { hasKeyboardFocus, keyboardFocusListeners } = useKeyboardOnlyFocus()\n\n    const getTransition = () => {\n      const duration = height.value / 1000 * 0.2\n      return `${duration > 0.2 ? duration : 0.2}s`\n    }\n\n    const getBackground = () => {\n      return props.color && props.colorAll\n        ? getHoverColor(getColor(props.color))\n        : ''\n    }\n\n    const uniqueId = computed(generateUniqueId)\n    const headerIdComputed = computed(() => `header-${uniqueId.value}`)\n    const panelIdComputed = computed(() => `panel-${uniqueId.value}`)\n    const tabIndexComputed = computed(() => props.disabled ? -1 : 0)\n\n    const headerAttributes = computed(() => ({\n      id: headerIdComputed.value,\n      tabindex: tabIndexComputed.value,\n      'aria-controls': panelIdComputed.value,\n      'aria-expanded': computedModelValue.value,\n      'aria-disabled': props.disabled,\n      role: 'button',\n    }))\n\n    const computedClasses = useBem('va-collapse', () => ({\n      ...pick(props, ['disabled', 'solid']),\n      expanded: computedModelValue.value,\n      active: props.solid && computedModelValue.value,\n      popout: !!(accordionProps.value.popout && computedModelValue.value),\n      inset: !!(accordionProps.value.inset && computedModelValue.value),\n    }))\n\n    return {\n      body,\n      height,\n\n      toggle,\n      computedModelValue,\n\n      hasKeyboardFocus,\n      keyboardFocusListeners,\n\n      textColorComputed,\n\n      headerIdComputed,\n      headerAttributes,\n      panelIdComputed,\n      tabIndexComputed,\n\n      computedClasses,\n\n      headerStyle: computed(() => ({\n        paddingLeft: props.icon && 0,\n        color: textColorComputed.value,\n        backgroundColor: props.color ? getColor(props.color) : '',\n      })),\n\n      contentStyle: computed(() => {\n        const hasContent = computedModelValue.value && !!slots.default?.()[0]\n\n        return {\n          visibility: hasContent ? 'visible' as const : 'hidden' as const,\n          height: `${height.value}px`,\n          transitionDuration: getTransition(),\n          background: hasContent ? getBackground() : '',\n        }\n      }),\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n@import \"../../styles/resources\";\n@import \"variables\";\n\n.va-collapse {\n  transition: var(--va-collapse-transition, var(--va-swing-transition));\n  font-family: var(--va-font-family);\n\n  &__body-wrapper {\n    position: relative;\n    transition: var(--va-collapse-body-transition);\n    overflow: hidden;\n  }\n\n  &__body {\n    position: absolute;\n    top: 0;\n    left: 0;\n  }\n\n  &__header {\n    display: var(--va-collapse-header-content-display);\n    justify-content: var(--va-collapse-header-content-justify-content);\n    cursor: var(--va-collapse-header-content-cursor);\n    background-color: var(--va-collapse-header-content-background-color);\n    box-shadow: var(--va-collapse-header-content-box-shadow, var(--va-block-box-shadow));\n    border-radius: var(--va-collapse-header-content-border-radius, var(--va-block-border-radius));\n    align-items: var(--va-collapse-header-content-align-items);\n    padding-top: var(--va-collapse-header-content-padding-top);\n    padding-bottom: var(--va-collapse-header-content-padding-bottom);\n    padding-left: var(--va-collapse-header-content-padding-left);\n\n    &__text {\n      width: var(--va-collapse-header-content-text-width);\n    }\n\n    &__icon {\n      @include flex-center();\n\n      min-width: var(--va-collapse-header-content-icon-min-width);\n      margin-left: var(--va-collapse-header-content-icon-margin-left);\n      margin-right: var(--va-collapse-header-content-icon-margin-right);\n      color: var(--va-collapse-header-content-icon-color);\n    }\n\n    &:focus {\n      @include focus-outline(var(--va-collapse-header-content-border-radius));\n    }\n  }\n\n  &--solid {\n    box-shadow: var(--va-collapse-solid-box-shadow);\n    border-radius: var(--va-collapse-solid-border-radius);\n\n    .va-collapse {\n      &__header {\n        border-radius: var(--va-collapse-solid-header-content-border-radius, var(--va-block-border-radius));\n        transition: var(--va-collapse-solid-header-content-transition);\n        box-shadow: var(--va-collapse-solid-header-content-box-shadow, var(--va-block-box-shadow));\n        background-color: var(--va-collapse-solid-header-content-background-color);\n      }\n\n      &__body {\n        border-radius: var(--va-collapse-solid-body-border-radius);\n        margin-top: var(--va-collapse-solid-body-margin-top);\n      }\n    }\n  }\n\n  &--popout {\n    margin: var(--va-collapse-popout-margin);\n  }\n\n  &--inset {\n    margin: var(--va-collapse-inset-margin);\n  }\n\n  &--disabled {\n    @include va-disabled();\n  }\n}\n</style>\n"],"names":["_sfc_main","defineComponent","name","components","VaIcon","props","modelValue","type","Boolean","default","disabled","header","String","icon","solid","color","textColor","colorAll","emits","setup","emit","slots","body","shallowRef","computedModelValue","useSyncProp","getColor","getHoverColor","useColors","accordionProps","toggle","useAccordionItem","textColorComputed","useTextColor","bodyHeight","ref","useResizeObserver","value","_b","_a","clientHeight","height","computed","hasKeyboardFocus","keyboardFocusListeners","useKeyboardOnlyFocus","getTransition","duration","uniqueId","generateUniqueId","headerIdComputed","panelIdComputed","tabIndexComputed","headerAttributes","id","tabindex","role","computedClasses","useBem","__spreadProps","__spreadValues","pick","expanded","active","popout","inset","headerStyle","paddingLeft","backgroundColor","contentStyle","hasContent","call","visibility","transitionDuration","background","_hoisted_1","class","_createElementBlock","_normalizeClass","_ctx","_createElementVNode","_mergeProps","_toHandlers","onFocus","_cache","$emit","onClick","args","onKeydown","_withKeys","_renderSlot","$slots","_normalizeProps","_guardReactiveProps","bind","attributes","style","_createBlock","_component_va_icon","key","_createCommentVNode","_toDisplayString","_createVNode","_normalizeStyle","_hoisted_2"],"mappings":"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"}