var e=Object.defineProperty,o=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,__defNormalProp=(o,t,r)=>t in o?e(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,__spreadValues=(e,o)=>{for(var t in o||(o={}))a.call(o,t)&&__defNormalProp(e,t,o[t]);if(r)for(var t of r(o))l.call(o,t)&&__defNormalProp(e,t,o[t]);return e};import{defineComponent as n,shallowRef as s,computed as p,ref as u,watch as i,nextTick as d,resolveComponent as c,openBlock as v,createBlock as m,withCtx as f,createVNode as y,createSlots as g,mergeProps as h,withModifiers as b,withKeys as w,createCommentVNode as O,renderSlot as x,createElementBlock as C,toDisplayString as I,normalizeProps as S,createTextVNode as V,normalizeStyle as k,createElementVNode as B}from"vue";import"../../../vendor.mjs";import{a as j,u as A,b as $}from"../../composables/useClearable.mjs";import{u as _}from"../../composables/useColors.mjs";import{u as P}from"../../composables/useFocusDeep.mjs";import{u as D}from"../../composables/useForm.mjs";import{u as T}from"../../composables/useLoading.mjs";import{u as F,a as H}from"../../composables/useMaxSelections.mjs";import"../../composables/useDropdown.mjs";import{a as L,u as E,b as N}from"../../composables/useValidation.mjs";import{u as M,a as q}from"../../composables/useSelectableList.mjs";import{V as K}from"../va-dropdown/index.mjs";import{V as U}from"../va-icon/index.mjs";import{V as W}from"../va-input/index.mjs";import{V as G}from"./VaSelectOptionList/index.mjs";import{_ as R}from"../../../plugin-vue_export-helper.mjs";import{V as z}from"../va-dropdown/components/VaDropdownContent/index.mjs";import{V as J}from"../va-input/components/VaInputWrapper/VaInputWrapper.mjs";const Q=n({name:"VaSelect",components:{VaSelectOptionList:G,VaIcon:U,VaDropdown:K,VaDropdownContent:z,VaInput:W,VaInputWrapper:J},emits:["update:modelValue","update-search","create-new","scroll-bottom",...L,...j],props:(X=__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues({},M),E),T),F),A),D),Y={modelValue:{type:[String,Number,Array,Object],default:""},placement:{type:String,default:"bottom",validator:e=>["top","bottom"].includes(e)},allowCreate:{type:[Boolean,String],default:!1,validator:e=>[!0,!1,"unique"].includes(e)},color:{type:String,default:"primary"},multiple:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},separator:{type:String,default:", "},width:{type:String,default:"100%"},maxHeight:{type:String,default:"256px"},noOptionsText:{type:String,default:"Items not found"},hideSelected:{type:Boolean,default:!1},tabindex:{type:Number,default:0},dropdownIcon:{type:[String,Object],default:()=>({open:"expand_more",close:"expand_less"}),validator:e=>{if("string"==typeof e)return!0;const o="string"==typeof e.open,t="string"==typeof e.close;return o&&t}},outline:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},label:{type:String,default:""},placeholder:{type:String,default:""},requiredMark:{type:Boolean,default:!1}},o(X,t(Y))),setup(e,{emit:o}){const t=s(),r=s(),a=s(),l=P(r),n=p((()=>l.value||K.value)),{getHoverColor:c,getColor:v}=_(),{getOptionByValue:m,getValue:f,getText:y,getTrackBy:g,getGroupBy:h}=q(e),{validate:b,computedError:w,computedErrorMessages:O}=N(e,o,(()=>reset()),(()=>focus())),x=p((()=>v(e.color))),C=p((()=>e.readonly?c(x.value):x.value)),I=u(""),S=p((()=>e.searchable||e.allowCreate));i(I,(e=>{o("update-search",e),M.value=null}));const V=p({get(){const o=m(e.modelValue);return e.multiple?o?Array.isArray(o)?o.map((e=>m(e))):[o]:[]:Array.isArray(o)&&o.length?o[o.length-1]:o},set(e){Array.isArray(e)?o("update:modelValue",e.map(f)):o("update:modelValue",f(e))}}),k=p((()=>V.value?"string"==typeof V.value||"number"==typeof V.value?V.value:Array.isArray(V.value)?V.value.map((e=>y(e))).join(e.separator)||e.clearValue:y(V.value):e.clearValue)),B=p((()=>e.placeholder&&!k.value)),{canBeCleared:j,clearIconProps:A,onFocus:D,onBlur:T}=$(e,V),F=p((()=>!!j.value&&(!e.multiple||!Array.isArray(V.value)||!!V.value.length))),L=p((()=>e.dropdownIcon?"string"==typeof e.dropdownIcon?e.dropdownIcon:K.value?e.dropdownIcon.close:e.dropdownIcon.open:"")),E=p((()=>e.options?e.hideSelected?e.options.filter((e=>!checkIsOptionSelected(e))):e.options:[])),checkIsOptionSelected=e=>!!V.value&&(Array.isArray(V.value)?!!V.value.find((o=>compareOptions(o,e))):compareOptions(V.value,e)),compareOptions=(e,o)=>{const t=f(e),r=f(o);return t===r||("string"==typeof t&&"string"==typeof r?t===r:null!==t&&null!==r&&("object"==typeof t&&"object"==typeof r&&g(t)===g(r)))},selectOption=t=>{var r;if(null!==M.value)if(S.value&&(I.value=""),e.multiple&&(r=V,Array.isArray(r.value))){const{exceedsMaxSelections:r,addOption:a}=H(V,u(e.maxSelections),o);if(checkIsOptionSelected(f(t)))V.value=V.value.filter((e=>!compareOptions(f(t),f(e))));else{if(r())return;a(f(t))}}else V.value="string"==typeof t||"number"==typeof t?t:__spreadValues({},t),hideAndFocus();else hideAndFocus()},M=u(null),selectHoveredOption=()=>{M.value&&(K.value?selectOption(M.value):showDropdown())},K=u(!1),U=p({get:()=>K.value,set:e=>{e?showDropdown():hideDropdown()}}),W=p((()=>!(e.multiple||e.searchable||e.allowCreate))),showDropdown=()=>{e.disabled||e.readonly||(K.value=!0,scrollToSelected(),focusSearchOrOptions())},hideDropdown=()=>{K.value=!1,I.value="",b()},toggleDropdown=()=>{K.value?hideAndFocus():showDropdown()},hideAndFocus=()=>{hideDropdown(),l.value=!0},focusSearchBar=()=>{var e;null==(e=a.value)||e.focus()},focusOptionList=()=>{var o,r;null==(o=t.value)||o.focus(),!e.modelValue&&(null==(r=t.value)||r.hoverFirstOption())},focusSearchOrOptions=()=>d((()=>{S.value?focusSearchBar():focusOptionList()})),focus=()=>{var o;e.disabled||null==(o=r.value)||o.focus()},reset=()=>{e.multiple?V.value=Array.isArray(e.clearValue)?e.clearValue:[]:V.value=e.clearValue,I.value="",o("clear")},G=p((()=>e.disabled?-1:e.tabindex)),scrollToSelected=()=>{const e=V.value;if("object"!=typeof e&&Array.isArray(e)&&!e.length)return;const o=Array.isArray(e)?e[e.length-1]:e;M.value=o,d((()=>{var e;return null==(e=t.value)?void 0:e.scrollToOption(o)}))};let R,z="";const J=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter"," "];return{isFocused:n,input:r,optionList:t,searchBar:a,reset:reset,focus:focus,blur:()=>{var e;U.value&&(U.value=!1),d(null==(e=r.value)?void 0:e.blur)},onInputFocus:()=>{l.value=!0,D()},onInputBlur:()=>{U.value||(T(),l.value?l.value=!1:b())},focusOptionList:focusOptionList,onSelectClick:()=>{e.disabled||e.readonly||toggleDropdown()},focusSearchBar:focusSearchBar,searchInput:I,showSearchInput:S,hoveredOption:M,tabIndexComputed:G,valueComputed:V,valueComputedString:k,showClearIcon:F,toggleIcon:L,computedErrorMessages:O,computedError:w,filteredOptions:E,checkIsOptionSelected:checkIsOptionSelected,closeOnContentClick:W,selectOption:selectOption,selectOrAddOption:()=>{const t=!!e.allowCreate&&""!==I.value;null!==M.value?selectHoveredOption():t&&(()=>{var t;const r=null==(t=e.options)?void 0:t.some((e=>y(e)===I.value));"unique"===e.allowCreate&&r||(o("create-new",I.value),I.value="")})()},selectHoveredOption:selectHoveredOption,hoverPreviousOption:()=>{var e;null==(e=t.value)||e.hoverPreviousOption()},hoverNextOption:()=>{var e;null==(e=t.value)||e.hoverNextOption()},showDropdownContentComputed:U,showDropdown:showDropdown,hideDropdown:hideDropdown,hideAndFocus:hideAndFocus,toggleDropdown:toggleDropdown,toggleIconColor:C,onHintedSearch:o=>{if(J.some((e=>e===o.key)))return;const t=1===o.key.length,r="Backspace"===o.key||"Delete"===o.key;if(clearTimeout(R),r?z=z?z.slice(0,-1):"":t&&(z+=o.key),S.value)I.value=z;else{if(z){const o=e.options.find((e=>y(e).toLowerCase().startsWith(z.toLowerCase())));o&&(M.value=o)}R=setTimeout((()=>{z=""}),1e3)}},getText:y,getTrackBy:g,getGroupBy:h,onScrollBottom:()=>{o("scroll-bottom")},clearIconProps:A,isPlaceholder:B}}});var X,Y;const Z={key:0,class:"va-select-anchor__placeholder"},ee={class:"va-select-dropdown__options-wrapper"};var oe=R(Q,[["render",function _sfc_render(e,o,t,r,a,l){const n=c("va-icon"),s=c("va-input-wrapper"),p=c("va-input"),u=c("va-select-option-list"),i=c("va-dropdown-content"),d=c("va-dropdown");return v(),m(d,{ref:"dropdown",class:"va-select va-select__dropdown va-select-dropdown","aria-label":`select option (currently selected: ${e.$props.modelValue})`,placement:e.$props.placement,disabled:e.$props.disabled,"max-height":e.$props.maxHeight,"close-on-content-click":e.closeOnContentClick,stateful:!1,offset:[1,0],"keep-anchor-width":"","keyboard-navigation":"","inner-anchor-selector":".va-input-wrapper__field",modelValue:e.showDropdownContentComputed,"onUpdate:modelValue":o[4]||(o[4]=o=>e.showDropdownContentComputed=o),onClose:e.focus},{anchor:f((()=>[y(s,{ref:"input",class:"va-select__anchor va-select-anchor__input","model-value":e.valueComputedString,success:e.$props.success,error:e.computedError,color:e.$props.color,label:e.$props.label,loading:e.$props.loading,disabled:e.$props.disabled,outline:e.$props.outline,bordered:e.$props.bordered,"required-mark":e.$props.requiredMark,messages:e.$props.messages,"error-messages":e.computedErrorMessages,focused:e.isFocused,tabindex:e.tabIndexComputed,onFocus:e.onInputFocus,onBlur:e.onInputBlur},g({icon:f((()=>[e.showClearIcon?(v(),m(n,h({key:0,role:"button","aria-hidden":"false","aria-label":"reset",tabindex:"0"},e.clearIconProps,{onClick:b(e.reset,["stop"]),onKeydown:[w(b(e.reset,["stop"]),["enter"]),w(b(e.reset,["stop"]),["space"])]}),null,16,["onClick","onKeydown"])):O("",!0)])),appendInner:f((()=>[e.$slots.appendInner?x(e.$slots,"appendInner",{key:0}):O("",!0),y(n,{color:e.toggleIconColor,name:e.toggleIcon},null,8,["color","name"])])),default:f((()=>[e.isPlaceholder?(v(),C("span",Z,I(e.$props.placeholder),1)):x(e.$slots,"content",S(h({key:1},{valueString:e.valueComputedString,value:e.valueComputed,tabindex:e.tabIndexComputed})),(()=>[V(I(e.valueComputedString),1)]))])),_:2},[e.$slots.prepend?{name:"prepend",fn:f((()=>[x(e.$slots,"prepend")]))}:void 0,e.$slots.append?{name:"append",fn:f((()=>[x(e.$slots,"append")]))}:void 0,e.$slots.prependInner?{name:"prependInner",fn:f((()=>[x(e.$slots,"prependInner")]))}:void 0]),1032,["model-value","success","error","color","label","loading","disabled","outline","bordered","required-mark","messages","error-messages","focused","tabindex","onFocus","onBlur"])])),default:f((()=>[y(i,{class:"va-select-dropdown__content",style:k({width:e.$props.width})},{default:f((()=>[e.showSearchInput?(v(),m(p,{key:0,ref:"searchBar",class:"va-select-dropdown__content-search-input",placeholder:"Search","aria-label":"options filter",tabindex:e.tabIndexComputed,bordered:!0,modelValue:e.searchInput,"onUpdate:modelValue":o[0]||(o[0]=o=>e.searchInput=o),onKeydown:[w(b(e.hoverPreviousOption,["stop","prevent"]),["up"]),w(b(e.hoverPreviousOption,["stop","prevent"]),["left"]),w(b(e.hoverNextOption,["stop","prevent"]),["down"]),w(b(e.hoverNextOption,["stop","prevent"]),["right"]),w(b(e.selectOrAddOption,["prevent"]),["enter"])],onFocus:o[1]||(o[1]=o=>e.hoveredOption=null)},null,8,["tabindex","modelValue","onKeydown"])):O("",!0),B("div",ee,[y(u,{ref:"optionList",hoveredOption:e.hoveredOption,"onUpdate:hoveredOption":o[2]||(o[2]=o=>e.hoveredOption=o),style:k({maxHeight:e.$props.maxHeight}),options:e.filteredOptions,"selected-value":e.valueComputed,"get-selected-state":e.checkIsOptionSelected,"get-text":e.getText,"get-track-by":e.getTrackBy,"get-group-by":e.getGroupBy,search:e.searchInput,"no-options-text":e.$props.noOptionsText,color:e.$props.color,tabindex:e.tabIndexComputed,onSelectOption:e.selectOption,onNoPreviousOptionToHover:e.focusSearchBar,onKeydown:[w(b(e.selectHoveredOption,["stop","prevent"]),["enter"]),w(b(e.selectHoveredOption,["stop","prevent"]),["space"]),o[3]||(o[3]=w(b((o=>e.searchBar&&e.searchBar.focus()),["stop","prevent"]),["tab"])),e.onHintedSearch],onScrollBottom:e.onScrollBottom},null,8,["hoveredOption","style","options","selected-value","get-selected-state","get-text","get-track-by","get-group-by","search","no-options-text","color","tabindex","onSelectOption","onNoPreviousOptionToHover","onKeydown","onScrollBottom"])])])),_:1},8,["style"])])),_:3},8,["aria-label","placement","disabled","max-height","close-on-content-click","modelValue","onClose"])}]]);export{oe as _};

import './VaSelect.css';
//# sourceMappingURL=VaSelect.mjs.map
