{"version":3,"file":"useDomRect.js","sources":["../../../../src/composables/useDomRect.ts"],"sourcesContent":["import { Ref, ref, watch } from 'vue'\nimport { useRequestAnimationFrame } from './useRequestAnimationFrame'\n\nconst keys = ['x', 'y', 'width', 'height', 'top', 'left', 'right', 'bottom']\nconst isDomRectEqual = (a: any, b: any) => {\n  for (let i = 0; i < keys.length; i++) {\n    if (a[keys[i]] !== b[keys[i]]) {\n      return false\n    }\n  }\n  return true\n}\n\nexport const useDomRect = (target: Ref<HTMLElement | undefined>) => {\n  const domRect = ref<DOMRect | null>(null)\n\n  let prev = {}\n  useRequestAnimationFrame(() => {\n    if (!target.value) { return }\n    const rect = target.value.getBoundingClientRect()\n    if (!isDomRectEqual(rect, prev)) {\n      domRect.value = rect\n    }\n    prev = rect\n  })\n\n  watch(target, (newVal) => {\n    if (newVal) {\n      domRect.value = newVal.getBoundingClientRect()\n    } else {\n      domRect.value = null\n    }\n  })\n\n  return {\n    domRect,\n  }\n}\n"],"names":[],"mappings":";;AAGA,MAAM,OAAO,CAAC,KAAK,KAAK,SAAS,UAAU,OAAO,QAAQ,SAAS,QAAQ;AAC3E,MAAM,iBAAiB,CAAC,GAAQ,MAAW;AACzC,WAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;AACpC,QAAI,EAAE,KAAK,QAAQ,EAAE,KAAK,KAAK;AACtB,aAAA;AAAA,IACT;AAAA,EACF;AACO,SAAA;AACT;AAEa,MAAA,aAAa,CAAC,WAAyC;AAC5D,QAAA,UAAU,IAAoB,IAAI;AAExC,MAAI,OAAO,CAAA;AACX,2BAAyB,MAAM;AACzB,QAAA,CAAC,OAAO,OAAO;AAAE;AAAA,IAAO;AACtB,UAAA,OAAO,OAAO,MAAM,sBAAsB;AAChD,QAAI,CAAC,eAAe,MAAM,IAAI,GAAG;AAC/B,cAAQ,QAAQ;AAAA,IAClB;AACO,WAAA;AAAA,EAAA,CACR;AAEK,QAAA,QAAQ,CAAC,WAAW;AACxB,QAAI,QAAQ;AACF,cAAA,QAAQ,OAAO;IAAsB,OACxC;AACL,cAAQ,QAAQ;AAAA,IAClB;AAAA,EAAA,CACD;AAEM,SAAA;AAAA,IACL;AAAA,EAAA;AAEJ;;"}