{"version":3,"file":"VaTreeCategory.js","sources":["../../../../../../src/components/va-tree-view/VaTreeCategory/VaTreeCategory.vue"],"sourcesContent":["<template>\n  <div class=\"va-tree-category\">\n    <div\n      class=\"va-tree-category__header\"\n      @click=\"toggle\"\n    >\n      <div class=\"va-tree-category__header-switcher\">\n        <square-with-icon\n          :icon=\"isOpenCached ? 'remove' : 'add'\"\n          :color=\"colorComputed\"\n        />\n      </div>\n      <div\n        class=\"va-tree-category__header-checkbox\"\n        v-if=\"$slots.checkbox\"\n      >\n        <slot name=\"checkbox\" />\n      </div>\n      <div\n        class=\"va-tree-category__header-icon\"\n        v-if=\"$props.icon\"\n      >\n        <va-icon\n          :name=\"$props.icon\"\n          :color=\"getColor('info')\"\n        />\n      </div>\n      <div class=\"va-tree-category__header-label\">\n        {{ $props.label }}\n      </div>\n    </div>\n\n    <div\n      class=\"va-tree-category__list-container\"\n      v-if=\"isOpenCached\"\n    >\n      <div class=\"va-tree-category__list-internal-container\">\n        <slot />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {\n  ComponentPublicInstance,\n  defineComponent,\n  inject,\n  nextTick,\n  onBeforeUnmount,\n  onMounted,\n  provide,\n  ref,\n  Ref,\n  watch,\n  computed,\n} from 'vue'\nimport SquareWithIcon from '../SquareWithIcon/SquareWithIcon.vue'\nimport VaIcon from '../../va-icon/VaIcon.vue'\nimport { useColors } from '../../../composables'\nimport { TreeCategory, TreeNodeCommon, TreeCategoryKey, TreeNodeComponent, TreeViewKey } from '../types'\nimport VaTreeNode from '../VaTreeNode/VaTreeNode.vue'\n\nexport default defineComponent({\n  name: 'VaTreeCategory',\n  components: {\n    SquareWithIcon,\n    VaIcon,\n  },\n  props: {\n    label: {\n      type: [String, Number],\n      default: '',\n    },\n    isOpen: {\n      type: Boolean,\n      default: false,\n    },\n    icon: {\n      type: String,\n      default: '',\n    },\n    color: {\n      type: String,\n      default: 'primary',\n    },\n  },\n  setup: (props) => {\n    const { getColor } = useColors()\n    const colorComputed = computed(() => getColor(props.color))\n\n    const nodes: Ref<TreeNodeComponent[]> = ref([])\n    const isOpenCached = ref<boolean | undefined>(false)\n\n    const onChildMounted = (node: TreeNodeComponent) => {\n      nodes.value.push(node)\n    }\n\n    const onChildUnmounted = (removableNode: TreeNodeComponent) => {\n      nodes.value = nodes.value.filter((node: TreeNodeComponent) => node !== removableNode)\n    }\n\n    const treeView: TreeNodeCommon<TreeCategory | typeof VaTreeNode> = inject(TreeViewKey, {\n      onChildMounted: (value: TreeCategory | typeof VaTreeNode) => undefined,\n      onChildUnmounted: (value: TreeCategory | typeof VaTreeNode) => undefined,\n    })\n\n    const collapse = () => {\n      isOpenCached.value = false\n\n      nextTick(() => {\n        nodes.value.forEach((child: ComponentPublicInstance) => {\n          if (child.$options.name === 'va-tree-category') {\n            (child as ComponentPublicInstance<TreeCategory>).collapse()\n          }\n        })\n      })\n    }\n\n    const expand = () => {\n      isOpenCached.value = true\n\n      nextTick(() => {\n        nodes.value.forEach((child: TreeNodeComponent) => {\n          child.expand?.()\n        })\n      })\n    }\n\n    const toggle = (e: MouseEvent) => {\n      if (!(e.target as HTMLElement).classList.contains('va-checkbox__input')) {\n        isOpenCached.value = !isOpenCached.value\n      }\n    }\n\n    watch(\n      () => props.isOpen,\n      (isOpen) => {\n        isOpenCached.value = isOpen\n      },\n      { immediate: true })\n\n    const treeCategory: TreeCategory = {\n      treeView,\n      nodes: nodes.value,\n      isOpenCached: isOpenCached.value,\n      onChildMounted,\n      onChildUnmounted,\n      collapse,\n      expand,\n      toggle,\n    }\n\n    provide(TreeCategoryKey, treeCategory)\n    onMounted(() => treeView?.onChildMounted(treeCategory))\n    onBeforeUnmount(() => treeView?.onChildUnmounted(treeCategory))\n\n    return {\n      treeCategory,\n      treeView,\n      nodes,\n      isOpenCached,\n      collapse,\n      expand,\n      toggle,\n      getColor,\n      colorComputed,\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n@import \"../../../styles/resources\";\n@import 'variables';\n\n.va-tree-category {\n  font-family: var(--va-font-family);\n\n  &__header {\n    cursor: var(--va-tree-category-header-cursor);\n    display: var(--va-tree-category-header-display);\n    align-items: var(--va-tree-category-header-align-items);\n  }\n\n  &__header-switcher {\n    margin-right: 0.5rem;\n  }\n\n  &__header-checkbox {\n    margin-right: var(--va-tree-category-header-checkbox-margin-right);\n    height: var(--va-tree-category-header-checkbox-height);\n    width: var(--va-tree-category-header-checkbox-width);\n    display: var(--va-tree-category-header-checkbox-display);\n    align-items: var(--va-tree-category-header-checkbox-align-items);\n    justify-content: var(--va-tree-category-header-checkbox-justify-content);\n\n    .va-checkbox__square {\n      width: 1.5rem;\n      height: 1.5rem;\n      flex: 0 0 1.5rem;\n    }\n  }\n\n  &__header-icon {\n    color: var(--va-tree-category-header-icon-color);\n    margin-right: var(--va-tree-category-header-icon-margin-right);\n    font-size: var(--va-tree-category-header-icon-font-size);\n    line-height: var(--va-tree-category-header-icon-line-height);\n  }\n\n  &__header-label {\n    word-wrap: var(--va-tree-category-header-label-word-wrap);\n    overflow: var(--va-tree-category-header-label-overflow);\n    line-height: var(--va-tree-category-header-label-line-height);\n  }\n\n  &__list-container {\n    margin-top: var(--va-tree-category-list-container-margin-top);\n    padding-left: var(--va-tree-category-list-container-padding-left);\n  }\n\n  &__list-internal-container {\n    background-image: linear-gradient(#adb3b9 33%, rgba(255, 255, 255, 0) 0%);\n    background-position: left;\n    background-size: 1px 3px;\n    background-repeat: repeat-y;\n    padding-left: 1.1875rem;\n  }\n\n  & + .va-tree-category,\n  .va-tree-node + .va-tree-node,\n  .va-tree-category + .va-tree-node,\n  .va-tree-node + .va-tree-category {\n    margin-top: 0.75rem;\n  }\n}\n</style>\n"],"names":["_openBlock","_createElementBlock","_createElementVNode","_createVNode","_renderSlot","_createCommentVNode","_toDisplayString"],"mappings":"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"}