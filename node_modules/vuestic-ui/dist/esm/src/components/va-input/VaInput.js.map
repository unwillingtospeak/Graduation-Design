{"version":3,"file":"VaInput.js","sources":["../../../../../src/components/va-input/VaInput.vue"],"sourcesContent":["<template>\n  <va-input-wrapper\n    v-bind=\"fieldListeners\"\n    class=\"va-input\"\n    :class=\"$attrs.class\"\n    :style=\"$attrs.style\"\n    :color=\"$props.color\"\n    :readonly=\"$props.readonly\"\n    :disabled=\"$props.disabled\"\n    :success=\"$props.success\"\n    :messages=\"$props.messages\"\n    :error=\"computedError\"\n    :error-messages=\"computedErrorMessages\"\n    :error-count=\"errorCount\"\n    :label=\"$props.label\"\n    :bordered=\"$props.bordered\"\n    :outline=\"$props.outline\"\n    :requiredMark=\"$props.requiredMark\"\n    :focused=\"isFocused\"\n    :counter-value=\"valueLengthComputed\"\n    :max-length=\"$props.maxLength\"\n    @click=\"focus\"\n  >\n    <!-- Simply proxy slots to VaInputWrapper -->\n    <template\n      v-for=\"name in filterSlots\"\n      :key=\"name\"\n      v-slot:[name]=\"slotScope\"\n    >\n      <slot :name=\"name\" v-bind=\"slotScope\" />\n    </template>\n\n    <template #icon=\"slotScope\">\n      <va-icon\n        v-if=\"canBeCleared\"\n        role=\"button\"\n        aria-hidden=\"false\"\n        aria-label=\"reset\"\n        class=\"va-input__icons__reset\"\n        :tabindex=\"tabIndexComputed\"\n        v-bind=\"clearIconProps\"\n        @click.stop=\"reset\"\n        @keydown.enter.stop=\"reset\"\n        @keydown.space.stop=\"reset\"\n      />\n      <va-icon\n        v-if=\"$props.loading\"\n        :color=\"$props.color\"\n        size=\"small\"\n        name=\"loop\"\n        spin=\"counter-clockwise\"\n      />\n      <slot name=\"icon\" v-bind=\"slotScope\" />\n    </template>\n\n    <VaTextarea\n      v-if=\"type === 'textarea' && !$slots.content\"\n      ref=\"input\"\n      v-bind=\"{ ...computedChildAttributes, ...textareaProps, ...inputEvents }\"\n      class=\"va-input__content__input\"\n    />\n\n    <input\n      v-else-if=\"!$slots.content\"\n      ref=\"input\"\n      class=\"va-input__content__input\"\n      v-bind=\"{ ...computedInputAttributes, ...inputEvents }\"\n      :value=\"computedValue\"\n    >\n  </va-input-wrapper>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, InputHTMLAttributes, shallowRef, toRefs } from 'vue'\nimport omit from 'lodash/omit.js'\nimport pick from 'lodash/pick.js'\n\nimport { extractComponentProps, filterComponentProps } from '../../utils/child-props'\n\nimport {\n  useFormProps,\n  useValidation, useValidationProps, useValidationEmits, ValidationProps,\n  useEmitProxy,\n  useClearable, useClearableProps, useClearableEmits,\n  useFocusDeep,\n} from '../../composables'\nimport { useCleave, useCleaveProps } from './hooks/useCleave'\n\nimport type { AnyStringPropType } from '../../types/prop-type'\n\nimport VaInputWrapper from './components/VaInputWrapper/VaInputWrapper.vue'\nimport VaTextarea from './components/VaTextarea/VaTextarea.vue'\nimport VaIcon from '../va-icon/VaIcon.vue'\n\nconst VaTextareaProps = extractComponentProps(VaTextarea)\n\nconst { createEmits: createInputEmits, createListeners: createInputListeners } = useEmitProxy(\n  ['change', 'keyup', 'keypress', 'keydown', 'focus', 'blur'],\n)\n\nconst { createEmits: createFieldEmits, createListeners: createFieldListeners } = useEmitProxy([\n  'click',\n  'click-prepend',\n  'click-append',\n  'click-prepend-inner',\n  'click-append-inner',\n])\n\nexport default defineComponent({\n  name: 'VaInput',\n\n  components: { VaInputWrapper, VaTextarea, VaIcon },\n\n  props: {\n    ...useFormProps,\n    ...useValidationProps as ValidationProps<string>,\n    ...useClearableProps,\n    ...useCleaveProps,\n    ...VaTextareaProps,\n\n    // input\n    placeholder: { type: String, default: '' },\n    tabindex: { type: Number, default: 0 },\n    modelValue: { type: [String, Number], default: '' },\n    label: { type: String, default: '' },\n    type: { type: String as AnyStringPropType<'textarea' | 'text' | 'password'>, default: 'text' },\n    loading: { type: Boolean, default: false },\n    inputClass: { type: String, default: '' },\n    pattern: { type: String },\n    inputmode: { type: String, default: 'text' },\n    ariaLabel: { type: String, default: undefined },\n    counter: { type: Boolean, default: false },\n    maxLength: { type: Number, default: undefined },\n\n    // style\n    color: { type: String, default: 'primary' },\n    outline: { type: Boolean, default: false },\n    bordered: { type: Boolean, default: false },\n    requiredMark: { type: Boolean, default: false },\n  },\n\n  emits: [\n    'update:modelValue',\n    ...useValidationEmits,\n    ...useClearableEmits,\n    ...createInputEmits(),\n    ...createFieldEmits(),\n  ],\n\n  inheritAttrs: false,\n\n  setup (props, { emit, attrs, slots }) {\n    const input = shallowRef<HTMLInputElement | typeof VaTextarea>()\n\n    const isFocused = useFocusDeep()\n\n    const reset = () => {\n      emit('update:modelValue', props.clearValue)\n      emit('clear')\n    }\n\n    const focus = () => {\n      input.value?.focus()\n    }\n\n    const blur = () => {\n      input.value?.blur()\n    }\n\n    const filterSlots = computed(() => {\n      const iconSlot = ['icon']\n      return Object.keys(slots).filter(slot => !iconSlot.includes(slot))\n    })\n\n    const {\n      computedError,\n      computedErrorMessages,\n      listeners: validationListeners,\n      validationAriaAttributes,\n    } = useValidation(props, emit, reset, focus)\n\n    const { modelValue } = toRefs(props)\n    const {\n      canBeCleared,\n      clearIconProps,\n    } = useClearable(props, modelValue, input, computedError)\n\n    /** Use cleave only if this component is input, because it will break. */\n    const computedCleaveTarget = computed(() => props.type === 'textarea'\n      ? undefined\n      : input.value as HTMLInputElement | undefined)\n\n    const { computedValue, onInput } = useCleave(computedCleaveTarget, props, emit)\n\n    const inputListeners = createInputListeners(emit)\n\n    /** Combine EmitProxy events with validation events to avoid events overriding */\n    const onFocus = (e: Event) => {\n      inputListeners.onFocus(e)\n      validationListeners.onFocus()\n    }\n\n    const onBlur = (e: Event) => {\n      inputListeners.onBlur(e)\n      validationListeners.onBlur()\n    }\n\n    const inputEvents = {\n      ...inputListeners,\n      onFocus,\n      onBlur,\n      onInput,\n    }\n\n    const tabIndexComputed = computed(() => props.disabled ? -1 : props.tabindex)\n\n    const computedChildAttributes = computed(() => ({\n      ariaLabel: props.ariaLabel || props.label,\n      ariaRequired: props.requiredMark,\n      tabindex: tabIndexComputed.value,\n      class: props.inputClass,\n      ariaDisabled: props.disabled,\n      ariaReadonly: props.readonly,\n      ...validationAriaAttributes.value,\n      ...omit(attrs, ['class', 'style']),\n    }) as InputHTMLAttributes)\n\n    const computedInputAttributes = computed(() => ({\n      ...computedChildAttributes.value,\n      ...pick(props, ['type', 'disabled', 'readonly', 'placeholder', 'pattern', 'inputmode']),\n    }) as InputHTMLAttributes)\n\n    const valueLengthComputed = computed(() =>\n      props.counter && typeof computedValue.value === 'string' ? computedValue.value.length : undefined,\n    )\n\n    return {\n      input,\n      inputEvents,\n\n      valueLengthComputed,\n      computedChildAttributes,\n      computedInputAttributes,\n      textareaProps: filterComponentProps(props, VaTextareaProps),\n      computedValue,\n      tabIndexComputed,\n\n      // Validations\n      computedError,\n      computedErrorMessages,\n      isFocused,\n\n      // Icon\n      canBeCleared,\n      clearIconProps,\n\n      fieldListeners: createFieldListeners(emit),\n      filterSlots,\n      reset,\n      focus,\n      blur,\n    }\n  },\n})\n</script>\n"],"names":["omit","pick","_createBlock","_mergeProps","_createSlots","_withCtx","_openBlock","_withModifiers","_withKeys","_createCommentVNode","_renderSlot","_createElementBlock","_renderList","_normalizeProps","_guardReactiveProps"],"mappings":"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"}